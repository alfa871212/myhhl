--------------------------------------------------
Simulating with r=1.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌─────────┐┌────────┐                        »
«    s_0: ┤ RY(8pi) ├┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├────────────────────────»
«         └────┬────┘└────┬────┘└────┬────┘└───┬────┘┌──────┐                »
«    j_0: ─────■──────────┼──────────┼─────────┼─────┤0     ├────────────────»
«                         │          │         │     │      │                »
«    j_1: ────────────────■──────────┼─────────┼─────┤1     ├────────────────»
«                                    │         │     │  qft │                »
«    j_2: ───────────────────────────■─────────┼─────┤2     ├────────────────»
«                                              │     │      │                »
«    j_3: ─────────────────────────────────────■─────┤3     ├───────■────────»
«                                                    └──────┘┌──────┴───────┐»
«    q_0: ───────────────────────────────────────────────────┤0             ├»
«                                                            │  gate_1/2_dg │»
«    q_1: ───────────────────────────────────────────────────┤1             ├»
«                                                            └──────────────┘»
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('00 0', 52726), ('11 0', 10403), ('10 1', 4344), ('01 1', 832), ('01 0', 2822), ('11 1', 1023), ('00 1', 3257), ('10 0', 24593)]
Our simulation...
[-0.58688789  0.29662512  0.67778379  0.32891531]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6094406415233447
Probability=0.09456
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(23.45) ├┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 35371), ('11 0', 9138), ('10 1', 12312), ('01 1', 3849), ('01 0', 3459), ('11 1', 4532), ('00 1', 13949), ('10 0', 17390)]
Our simulation...
[-0.63455615  0.33332852  0.59615999  0.36169581]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.5953715931017333
Probability=0.34642
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(21.879) ├┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├────────»
«         └─────┬──────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼────────────┼─────────────┼───────┤0     ├»
«                             │            │             │       │      │»
«    j_1: ────────────────────■────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 20029), ('11 0', 12541), ('10 1', 15040), ('01 1', 7640), ('01 0', 7324), ('11 1', 6486), ('00 1', 15611), ('10 0', 15329)]
Our simulation...
[-0.59045644  0.41306575  0.57955735  0.38059316]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6446496401459626
Probability=0.44777
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(20.414) ├┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 15144), ('11 0', 17364), ('10 1', 13112), ('01 1', 9679), ('01 0', 11922), ('11 1', 5830), ('00 1', 7834), ('10 0', 19115)]
Our simulation...
[-0.46356777  0.51527218  0.5997302   0.39990398]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7404062053223448
Probability=0.36455000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(19.047) ├┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 10019), ('11 0', 19030), ('10 1', 16406), ('01 1', 7221), ('01 0', 16952), ('11 1', 6230), ('00 1', 6477), ('10 0', 17665)]
Our simulation...
[-0.42221178  0.44580206  0.67196205  0.41408302]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7831188607508698
Probability=0.36334
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(17.772) ├┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 7467), ('11 0', 16828), ('10 1', 19265), ('01 1', 4281), ('01 0', 19084), ('11 1', 8112), ('00 1', 9017), ('10 0', 15946)]
Our simulation...
[-0.47083339  0.32442091  0.6882096   0.44658095]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7640536555469245
Probability=0.40674999999999994
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(16.581) ├┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 10029), ('11 0', 13692), ('10 1', 20837), ('01 1', 5774), ('01 0', 14729), ('11 1', 10198), ('00 1', 10364), ('10 0', 14377)]
Our simulation...
[-0.46872374  0.34985787  0.66461608  0.46495482]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.778846687067462
Probability=0.47173000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(15.471) ├┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 16315), ('11 0', 13292), ('10 1', 22927), ('01 1', 7483), ('01 0', 9647), ('11 1', 9600), ('00 1', 9381), ('10 0', 11355)]
Our simulation...
[-0.43581348  0.38923686  0.68131775  0.44087118]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7897369679062017
Probability=0.49391
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(14.435) ├┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 21496), ('11 0', 15946), ('10 1', 23103), ('01 1', 6792), ('01 0', 7059), ('11 1', 7465), ('00 1', 8516), ('10 0', 9623)]
Our simulation...
[-0.43084897  0.38477431  0.70964544  0.40338722]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7694450199038531
Probability=0.45876
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(13.468) ├┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23144), ('11 0', 16539), ('10 1', 19517), ('01 1', 6115), ('01 0', 5757), ('11 1', 8134), ('00 1', 9681), ('10 0', 11113)]
Our simulation...
[-0.47204153  0.37516156  0.67023428  0.43268535]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7619712896072299
Probability=0.43446999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌────────┐┌──────────┐                        »
«    s_0: ┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├────────────────────────»
«         └────┬────┘└────┬────┘└───┬────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■──────────┼─────────┼──────────┼──────┤0     ├────────────────»
«                         │         │          │      │      │                »
«    j_1: ────────────────■─────────┼──────────┼──────┤1     ├────────────────»
«                                   │          │      │  qft │                »
«    j_2: ──────────────────────────■──────────┼──────┤2     ├────────────────»
«                                              │      │      │                »
«    j_3: ─────────────────────────────────────■──────┤3     ├───────■────────»
«                                                     └──────┘┌──────┴───────┐»
«    q_0: ────────────────────────────────────────────────────┤0             ├»
«                                                             │  gate_1/2_dg │»
«    q_1: ────────────────────────────────────────────────────┤1             ├»
«                                                             └──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('00 0', 22599), ('11 0', 14483), ('10 1', 14182), ('01 1', 5921), ('01 0', 5456), ('11 1', 12236), ('00 1', 10884), ('10 0', 14239)]
Our simulation...
[-0.50180711  0.37011789  0.57281092  0.53206205]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7824347414935245
Probability=0.43222999999999995
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 22187), ('11 0', 11463), ('10 1', 9737), ('01 1', 6412), ('01 0', 6016), ('11 1', 17460), ('00 1', 10162), ('10 0', 16563)]
Our simulation...
[-0.4818328   0.38273971  0.47164947  0.63158075]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8065406459742889
Probability=0.43771
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 19979), ('11 0', 10216), ('10 1', 7578), ('01 1', 8062), ('01 0', 6735), ('11 1', 20531), ('00 1', 9485), ('10 0', 17414)]
Our simulation...
[-0.45579519  0.42021589  0.40740689  0.67058853]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8101223290251343
Probability=0.45655999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 16472), ('11 0', 11624), ('10 1', 6936), ('01 1', 10745), ('01 0', 7324), ('11 1', 20620), ('00 1', 9484), ('10 0', 16795)]
Our simulation...
[-0.44550233  0.47419549  0.38098576  0.6568989 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.800288869445374
Probability=0.47785
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 12091), ('11 0', 13650), ('10 1', 6829), ('01 1', 13154), ('01 0', 8608), ('11 1', 19265), ('00 1', 10497), ('10 0', 15906)]
Our simulation...
[-0.45936498  0.5142262   0.37051333  0.62231431]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.774236106851744
Probability=0.49745
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 8216), ('11 0', 15490), ('10 1', 6732), ('01 1', 14421), ('01 0', 11279), ('11 1', 18066), ('00 1', 10442), ('10 0', 15354)]
Our simulation...
[-0.45854727  0.53887739  0.3681835   0.60314714]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7644312974260719
Probability=0.49661
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 6291), ('11 0', 15799), ('10 1', 6597), ('01 1', 14096), ('01 0', 15488), ('11 1', 17923), ('00 1', 9163), ('10 0', 14643)]
Our simulation...
[-0.43792558  0.54316205  0.37158204  0.61247283]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7804451888804842
Probability=0.47779
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 5829), ('11 0', 14775), ('10 1', 6491), ('01 1', 12101), ('01 0', 20207), ('11 1', 18797), ('00 1', 7480), ('10 0', 14320)]
Our simulation...
[-0.40829833  0.51932285  0.38034929  0.64724853]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8145408730901428
Probability=0.44869000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 5773), ('11 0', 13159), ('10 1', 6776), ('01 1', 10226), ('01 0', 24963), ('11 1', 20049), ('00 1', 5532), ('10 0', 13522)]
Our simulation...
[-0.36043168  0.49004365  0.39890417  0.68616448]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8599108485185836
Probability=0.42583
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 6103), ('11 0', 11980), ('10 1', 7132), ('01 1', 8607), ('01 0', 28336), ('11 1', 20803), ('00 1', 4195), ('10 0', 12844)]
Our simulation...
[-0.32090129  0.45965436  0.41841876  0.71460897]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8936468396593984
Probability=0.40736999999999995
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌────────┐┌──────────┐┌──────────┐                        »
«    s_0: ┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├────────────────────────»
«         └────┬────┘└───┬────┘└────┬─────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■─────────┼──────────┼───────────┼──────┤0     ├────────────────»
«                        │          │           │      │      │                »
«    j_1: ───────────────■──────────┼───────────┼──────┤1     ├────────────────»
«                                   │           │      │  qft │                »
«    j_2: ──────────────────────────■───────────┼──────┤2     ├────────────────»
«                                               │      │      │                »
«    j_3: ──────────────────────────────────────■──────┤3     ├───────■────────»
«                                                      └──────┘┌──────┴───────┐»
«    q_0: ─────────────────────────────────────────────────────┤0             ├»
«                                                              │  gate_1/2_dg │»
«    q_1: ─────────────────────────────────────────────────────┤1             ├»
«                                                              └──────────────┘»
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('00 0', 6240), ('11 0', 11637), ('10 1', 7566), ('01 1', 7743), ('01 0', 30917), ('11 1', 20339), ('00 1', 3475), ('10 0', 12083)]
Our simulation...
[-0.29803092  0.44487557  0.43976139  0.72102234]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9134234791299298
Probability=0.39123
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 6154), ('11 0', 12203), ('10 1', 8079), ('01 1', 7242), ('01 0', 31868), ('11 1', 19482), ('00 1', 3565), ('10 0', 11407)]
Our simulation...
[-0.30482121  0.43445488  0.45887482  0.71257764]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9169838509004454
Probability=0.38368
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 6124), ('11 0', 13426), ('10 1', 8456), ('01 1', 7468), ('01 0', 32227), ('11 1', 17619), ('00 1', 3715), ('10 0', 10965)]
Our simulation...
[-0.31576911  0.44770545  0.47640106  0.68767124]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9141512780251045
Probability=0.37258
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 6429), ('11 0', 14726), ('10 1', 8838), ('01 1', 7820), ('01 0', 31434), ('11 1', 15843), ('00 1', 4257), ('10 0', 10653)]
Our simulation...
[-0.34031092  0.46124051  0.49034422  0.65651216]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9004716789724656
Probability=0.36758
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 6810), ('11 0', 15346), ('10 1', 9226), ('01 1', 8543), ('01 0', 30487), ('11 1', 14652), ('00 1', 4705), ('10 0', 10231)]
Our simulation...
[-0.35599241  0.47969603  0.49850285  0.62821655]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8868112588012004
Probability=0.37126
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 7015), ('11 0', 15935), ('10 1', 9709), ('01 1', 9452), ('01 0', 28519), ('11 1', 13640), ('00 1', 5446), ('10 0', 10284)]
Our simulation...
[-0.37734633  0.49712221  0.50383527  0.59718446]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8663567115037232
Probability=0.38247000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 7364), ('11 0', 15843), ('10 1', 10187), ('01 1', 10408), ('01 0', 27035), ('11 1', 13108), ('00 1', 5740), ('10 0', 10315)]
Our simulation...
[-0.3814793   0.51368711  0.50820412  0.57647867]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8561869394126244
Probability=0.39443000000000006
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 8088), ('11 0', 15465), ('10 1', 10486), ('01 1', 11255), ('01 0', 25420), ('11 1', 13128), ('00 1', 6231), ('10 0', 9927)]
Our simulation...
[-0.38936595  0.52330133  0.50510773  0.56516905]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8455915295961923
Probability=0.411
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 8624), ('11 0', 14315), ('10 1', 10843), ('01 1', 12042), ('01 0', 23680), ('11 1', 13650), ('00 1', 6758), ('10 0', 10088)]
Our simulation...
[-0.39509383  0.52740042  0.50045599  0.56150999]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8391888417423746
Probability=0.43293000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 9389), ('11 0', 13407), ('10 1', 11031), ('01 1', 12455), ('01 0', 22081), ('11 1', 14686), ('00 1', 6986), ('10 0', 9965)]
Our simulation...
[-0.39332082  0.52517557  0.49424251  0.5702751 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8419982941738776
Probability=0.45158
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────┐┌──────────┐┌──────────┐┌──────────┐        »
«    s_0: ┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├────────»
«         └───┬────┘└────┬─────┘└────┬─────┘└────┬─────┘┌──────┐»
«    j_0: ────■──────────┼───────────┼───────────┼──────┤0     ├»
«                        │           │           │      │      │»
«    j_1: ───────────────■───────────┼───────────┼──────┤1     ├»
«                                    │           │      │  qft │»
«    j_2: ───────────────────────────■───────────┼──────┤2     ├»
«                                                │      │      │»
«    j_3: ───────────────────────────────────────■──────┤3     ├»
«                                                       └──────┘»
«    q_0: ──────────────────────────────────────────────────────»
«                                                               »
«    q_1: ──────────────────────────────────────────────────────»
«                                                               »
«   cr_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_1: ══════════════════════════════════════════════════════»
«                                                               »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 9886), ('11 0', 12727), ('10 1', 11159), ('01 1', 12919), ('01 0', 21003), ('11 1', 14971), ('00 1', 7102), ('10 0', 10233)]
Our simulation...
[-0.39228326  0.5290831   0.49172476  0.56955392]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8409281731506383
Probability=0.46151
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 10934), ('11 0', 12069), ('10 1', 11291), ('01 1', 12945), ('01 0', 19797), ('11 1', 15107), ('00 1', 7283), ('10 0', 10574)]
Our simulation...
[-0.39522197  0.52691061  0.49209859  0.56921329]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8396768980896449
Probability=0.46626000000000006
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 11659), ('11 0', 11469), ('10 1', 10980), ('01 1', 13151), ('01 0', 19196), ('11 1', 15304), ('00 1', 7245), ('10 0', 10996)]
Our simulation...
[-0.39396149  0.53077929  0.48499331  0.57258116]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8388267582888227
Probability=0.4668
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 12580), ('11 0', 11406), ('10 1', 10729), ('01 1', 12761), ('01 0', 18622), ('11 1', 15382), ('00 1', 6932), ('10 0', 11588)]
Our simulation...
[-0.38902506  0.52782584  0.48398056  0.57950168]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8441215999384661
Probability=0.45804
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 13231), ('11 0', 11122), ('10 1', 10292), ('01 1', 12200), ('01 0', 18583), ('11 1', 15252), ('00 1', 6812), ('10 0', 12508)]
Our simulation...
[-0.39100672  0.52327118  0.48061441  0.58507333]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.844670063403802
Probability=0.44556
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 14088), ('11 0', 11729), ('10 1', 9795), ('01 1', 11686), ('01 0', 18248), ('11 1', 14741), ('00 1', 6491), ('10 0', 13222)]
Our simulation...
[-0.38983046  0.52306168  0.47887502  0.58746695]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8456014753203525
Probability=0.42713
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 15032), ('11 0', 12026), ('10 1', 9093), ('01 1', 11146), ('01 0', 18514), ('11 1', 14065), ('00 1', 6044), ('10 0', 14080)]
Our simulation...
[-0.38703587  0.52559172  0.47472553  0.59041701]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8463618910005711
Probability=0.40348
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 15801), ('11 0', 12963), ('10 1', 8482), ('01 1', 10345), ('01 0', 18681), ('11 1', 13228), ('00 1', 5872), ('10 0', 14628)]
Our simulation...
[-0.39347648  0.5222651   0.47290607  0.59057199]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8428884198427609
Probability=0.37927
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 16651), ('11 0', 13475), ('10 1', 7834), ('01 1', 9485), ('01 0', 18983), ('11 1', 12489), ('00 1', 5289), ('10 0', 15794)]
Our simulation...
[-0.38819665  0.51985673  0.47245101  0.59652525]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8478996217059914
Probability=0.35097
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 17349), ('11 0', 14353), ('10 1', 7182), ('01 1', 8903), ('01 0', 19186), ('11 1', 11507), ('00 1', 4966), ('10 0', 16554)]
Our simulation...
[-0.39054807  0.52292491  0.4696711   0.59450046]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8445996620884761
Probability=0.32558
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌──────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├────────»
«         └────┬─────┘└────┬─────┘└────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼───────────┼────────────┼──────┤0     ├»
«                          │           │            │      │      │»
«    j_1: ─────────────────■───────────┼────────────┼──────┤1     ├»
«                                      │            │      │  qft │»
«    j_2: ─────────────────────────────■────────────┼──────┤2     ├»
«                                                   │      │      │»
«    j_3: ──────────────────────────────────────────■──────┤3     ├»
«                                                          └──────┘»
«    q_0: ─────────────────────────────────────────────────────────»
«                                                                  »
«    q_1: ─────────────────────────────────────────────────────────»
«                                                                  »
«   cr_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_1: ═════════════════════════════════════════════════════════»
«                                                                  »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 18342), ('11 0', 15218), ('10 1', 6522), ('01 1', 7906), ('01 0', 19847), ('11 1', 10552), ('00 1', 4499), ('10 0', 17114)]
Our simulation...
[-0.39066241  0.51787152  0.47036394  0.598289  ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8467554481457349
Probability=0.29479
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 19137), ('11 0', 15968), ('10 1', 5876), ('01 1', 7240), ('01 0', 20278), ('11 1', 9551), ('00 1', 4102), ('10 0', 17848)]
Our simulation...
[-0.39145492  0.52005971  0.46851642  0.59732178]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8450808033336288
Probability=0.26769
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 19530), ('11 0', 16963), ('10 1', 5416), ('01 1', 6500), ('01 0', 20491), ('11 1', 8651), ('00 1', 3747), ('10 0', 18702)]
Our simulation...
[-0.39256687  0.51704515  0.47196644  0.59649245]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8457967741830327
Probability=0.24314000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 20229), ('11 0', 17597), ('10 1', 4783), ('01 1', 5786), ('01 0', 20881), ('11 1', 7864), ('00 1', 3364), ('10 0', 19496)]
Our simulation...
[-0.3928526   0.51521779  0.46843769  0.60065264]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8460721512889421
Probability=0.21797
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 20623), ('11 0', 18440), ('10 1', 4186), ('01 1', 5054), ('01 0', 21538), ('11 1', 7219), ('00 1', 3000), ('10 0', 19940)]
Our simulation...
[-0.39264527  0.50963279  0.46380919  0.6090855 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8480099085094637
Probability=0.19459
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 21217), ('11 0', 19027), ('10 1', 3862), ('01 1', 4542), ('01 0', 21635), ('11 1', 6563), ('00 1', 2585), ('10 0', 20569)]
Our simulation...
[-0.38376642  0.50869827  0.46907559  0.61148794]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.855391420339442
Probability=0.17552
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 21568), ('11 0', 19647), ('10 1', 3376), ('01 1', 4210), ('01 0', 22185), ('11 1', 5655), ('00 1', 2335), ('10 0', 21024)]
Our simulation...
[-0.38718228  0.51989193  0.46555742  0.6025434 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8480632669368051
Probability=0.15576
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 22136), ('11 0', 20192), ('10 1', 3059), ('01 1', 3728), ('01 0', 22198), ('11 1', 5128), ('00 1', 2079), ('10 0', 21480)]
Our simulation...
[-0.38543958  0.51613941  0.46754003  0.60534516]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8510846307909931
Probability=0.13994
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 22493), ('11 0', 20892), ('10 1', 2748), ('01 1', 3206), ('01 0', 22504), ('11 1', 4407), ('00 1', 1878), ('10 0', 21872)]
Our simulation...
[-0.39171917  0.51181003  0.47384401  0.60006536]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8487527780205696
Probability=0.12239
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 22824), ('11 0', 21179), ('10 1', 2289), ('01 1', 2828), ('01 0', 22916), ('11 1', 3956), ('00 1', 1581), ('10 0', 22427)]
Our simulation...
[-0.38522068  0.5152089   0.46351794  0.60935699]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.851202542295294
Probability=0.10654000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├────────»
«         └────┬─────┘└────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼────────────┼────────────┼──────┤0     ├»
«                          │            │            │      │      │»
«    j_1: ─────────────────■────────────┼────────────┼──────┤1     ├»
«                                       │            │      │  qft │»
«    j_2: ──────────────────────────────■────────────┼──────┤2     ├»
«                                                    │      │      │»
«    j_3: ───────────────────────────────────────────■──────┤3     ├»
«                                                           └──────┘»
«    q_0: ──────────────────────────────────────────────────────────»
«                                                                   »
«    q_1: ──────────────────────────────────────────────────────────»
«                                                                   »
«   cr_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_1: ══════════════════════════════════════════════════════════»
«                                                                   »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23053), ('11 0', 21737), ('10 1', 2080), ('01 1', 2516), ('01 0', 23257), ('11 1', 3475), ('00 1', 1449), ('10 0', 22433)]
Our simulation...
[-0.39013572  0.51408726  0.46742635  0.60416969]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8484649286336006
Probability=0.0952
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23083), ('11 0', 22031), ('10 1', 1801), ('01 1', 2342), ('01 0', 23441), ('11 1', 3155), ('00 1', 1268), ('10 0', 22879)]
Our simulation...
[-0.38474288  0.52288287  0.45853007  0.60689093]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8478349594214347
Probability=0.08566
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23499), ('11 0', 22425), ('10 1', 1589), ('01 1', 1918), ('01 0', 23464), ('11 1', 2739), ('00 1', 1132), ('10 0', 23234)]
Our simulation...
[-0.39170029  0.50986474  0.46407975  0.6092937 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8486454301227196
Probability=0.07378
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23618), ('11 0', 22731), ('10 1', 1349), ('01 1', 1747), ('01 0', 23890), ('11 1', 2321), ('00 1', 1014), ('10 0', 23330)]
Our simulation...
[-0.39708156  0.52120335  0.45800131  0.60075627]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8393685513587
Probability=0.06431
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23707), ('11 0', 23014), ('10 1', 1211), ('01 1', 1496), ('01 0', 23958), ('11 1', 2081), ('00 1', 858), ('10 0', 23675)]
Our simulation...
[-0.38982816  0.51474882  0.46312864  0.60710751]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8479894390032305
Probability=0.056459999999999996
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 23966), ('11 0', 23351), ('10 1', 1045), ('01 1', 1347), ('01 0', 24317), ('11 1', 1785), ('00 1', 787), ('10 0', 23402)]
Our simulation...
[-0.3981727   0.52091626  0.45881991  0.59965744]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8387526771263155
Probability=0.049640000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24036), ('11 0', 23351), ('10 1', 982), ('01 1', 1148), ('01 0', 24320), ('11 1', 1623), ('00 1', 657), ('10 0', 23883)]
Our simulation...
[-0.38597875  0.51021315  0.4718853   0.60665246]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8534726530837244
Probability=0.0441
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24088), ('11 0', 23535), ('10 1', 854), ('01 1', 1022), ('01 0', 24457), ('11 1', 1431), ('00 1', 607), ('10 0', 24006)]
Our simulation...
[-0.39380746  0.5109931   0.46710931  0.60465745]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8469535753240328
Probability=0.03914
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24294), ('11 0', 23796), ('10 1', 735), ('01 1', 887), ('01 0', 24141), ('11 1', 1255), ('00 1', 513), ('10 0', 24379)]
Our simulation...
[-0.38900827  0.51151922  0.46563307  0.60844596]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8501404228415728
Probability=0.0339
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24303), ('11 0', 24100), ('10 1', 613), ('01 1', 739), ('01 0', 24442), ('11 1', 1023), ('00 1', 399), ('10 0', 24381)]
Our simulation...
[-0.37925666  0.51614175  0.47008567  0.60727386]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8557849542704019
Probability=0.02774
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌───────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├────────»
«         └────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■────────────┼────────────┼────────────┼──────┤0     ├»
«                           │            │            │      │      │»
«    j_1: ──────────────────■────────────┼────────────┼──────┤1     ├»
«                                        │            │      │  qft │»
«    j_2: ───────────────────────────────■────────────┼──────┤2     ├»
«                                                     │      │      │»
«    j_3: ────────────────────────────────────────────■──────┤3     ├»
«                                                            └──────┘»
«    q_0: ───────────────────────────────────────────────────────────»
«                                                                    »
«    q_1: ───────────────────────────────────────────────────────────»
«                                                                    »
«   cr_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_1: ═══════════════════════════════════════════════════════════»
«                                                                    »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24532), ('11 0', 24197), ('10 1', 554), ('01 1', 647), ('01 0', 24594), ('11 1', 978), ('00 1', 375), ('10 0', 24123)]
Our simulation...
[-0.38318208  0.50331711  0.46574096  0.61881236]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8574274682472025
Probability=0.02554
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24443), ('11 0', 24018), ('10 1', 442), ('01 1', 573), ('01 0', 24777), ('11 1', 794), ('00 1', 332), ('10 0', 24621)]
Our simulation...
[-0.3937864   0.51733156  0.45436284  0.60897844]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8429963127814596
Probability=0.02141
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24487), ('11 0', 24444), ('10 1', 406), ('01 1', 541), ('01 0', 24538), ('11 1', 733), ('00 1', 270), ('10 0', 24581)]
Our simulation...
[-0.3721042   0.52672184  0.456295    0.61310475]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8548833806439958
Probability=0.0195
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24481), ('11 0', 24617), ('10 1', 348), ('01 1', 428), ('01 0', 24782), ('11 1', 621), ('00 1', 232), ('10 0', 24491)]
Our simulation...
[-0.37738397  0.51257963  0.46219908  0.61742649]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8576346319062834
Probability=0.01629
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24964), ('11 0', 24314), ('10 1', 338), ('01 1', 374), ('01 0', 24561), ('11 1', 544), ('00 1', 231), ('10 0', 24674)]
Our simulation...
[-0.39413999  0.50151083  0.47676335  0.60484482]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8512099661879304
Probability=0.01487
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 25080), ('11 0', 24504), ('10 1', 281), ('01 1', 290), ('01 0', 24730), ('11 1', 458), ('00 1', 191), ('10 0', 24466)]
Our simulation...
[-0.39567332  0.48754991  0.47992486  0.61270697]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8552969075282516
Probability=0.0122
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24615), ('11 0', 24767), ('10 1', 224), ('01 1', 276), ('01 0', 24620), ('11 1', 469), ('00 1', 154), ('10 0', 24875)]
Our simulation...
[-0.3703143   0.49575221  0.44661585  0.64624403]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.865522882347063
Probability=0.011229999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24557), ('11 0', 24881), ('10 1', 197), ('01 1', 235), ('01 0', 24855), ('11 1', 356), ('00 1', 159), ('10 0', 24760)]
Our simulation...
[-0.40975435  0.49814863  0.45609795  0.61312639]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8384907588892079
Probability=0.00947
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24995), ('11 0', 24882), ('10 1', 157), ('01 1', 213), ('01 0', 24444), ('11 1', 299), ('00 1', 126), ('10 0', 24884)]
Our simulation...
[-0.39810874  0.51761427  0.44439203  0.61327044]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8382644503009935
Probability=0.00795
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24741), ('11 0', 24865), ('10 1', 160), ('01 1', 172), ('01 0', 24838), ('11 1', 283), ('00 1', 137), ('10 0', 24804)]
Our simulation...
[-0.42682649  0.47825036  0.4612656   0.61345724]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8324361590000053
Probability=0.00752
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌───────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼────────────┼───────┤0     ├»
«                            │            │            │       │      │»
«    j_1: ───────────────────■────────────┼────────────┼───────┤1     ├»
«                                         │            │       │  qft │»
«    j_2: ────────────────────────────────■────────────┼───────┤2     ├»
«                                                      │       │      │»
«    j_3: ─────────────────────────────────────────────■───────┤3     ├»
«                                                              └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────»
«                                                                      »
«    q_1: ─────────────────────────────────────────────────────────────»
«                                                                      »
«   cr_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_1: ═════════════════════════════════════════════════════════════»
«                                                                      »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24921), ('11 0', 24648), ('10 1', 134), ('01 1', 160), ('01 0', 24912), ('11 1', 251), ('00 1', 92), ('10 0', 24882)]
Our simulation...
[-0.38003553  0.50117601  0.45865136  0.6277217 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8594073536210748
Probability=0.00637
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24846), ('11 0', 24805), ('10 1', 116), ('01 1', 132), ('01 0', 24946), ('11 1', 195), ('00 1', 92), ('10 0', 24868)]
Our simulation...
[-0.41468376  0.4967182   0.46564195  0.60372674]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8362778669633792
Probability=0.00535
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 25106), ('11 0', 24894), ('10 1', 87), ('01 1', 118), ('01 0', 24850), ('11 1', 177), ('00 1', 88), ('10 0', 24680)]
Our simulation...
[-0.43270549  0.5010627   0.43023991  0.61367397]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8154136812702193
Probability=0.0047
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24676), ('11 0', 25035), ('10 1', 82), ('01 1', 129), ('01 0', 24878), ('11 1', 156), ('00 1', 61), ('10 0', 24983)]
Our simulation...
[-0.37752267  0.54900079  0.43770856  0.60372674]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8384167394124806
Probability=0.00428
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24928), ('11 0', 24896), ('10 1', 85), ('01 1', 102), ('01 0', 24831), ('11 1', 139), ('00 1', 70), ('10 0', 24949)]
Our simulation...
[-0.42043748  0.50751922  0.46329954  0.59246105]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8272898200745488
Probability=0.00396
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24849), ('11 0', 24771), ('10 1', 57), ('01 1', 76), ('01 0', 25078), ('11 1', 105), ('00 1', 48), ('10 0', 25016)]
Our simulation...
[-0.40967325  0.5154942   0.44643107  0.6059149 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8306877673840858
Probability=0.00286
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 25040), ('11 0', 24761), ('10 1', 53), ('01 1', 66), ('01 0', 25095), ('11 1', 108), ('00 1', 39), ('10 0', 24838)]
Our simulation...
[-0.38290539  0.49811675  0.44637218  0.63719309]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8563444776374449
Probability=0.0026600000000000005
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24908), ('11 0', 24833), ('10 1', 54), ('01 1', 60), ('01 0', 25062), ('11 1', 74), ('00 1', 40), ('10 0', 24969)]
Our simulation...
[-0.41885391  0.51298918  0.48666426  0.56970291]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.82707892579218
Probability=0.00228
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24899), ('11 0', 24998), ('10 1', 46), ('01 1', 51), ('01 0', 25078), ('11 1', 80), ('00 1', 29), ('10 0', 24819)]
Our simulation...
[-0.37520221  0.4975669   0.47254732  0.62317695]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8658220916949639
Probability=0.00206
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24948), ('11 0', 24848), ('10 1', 42), ('01 1', 41), ('01 0', 24856), ('11 1', 87), ('00 1', 22), ('10 0', 25156)]
Our simulation...
[-0.3385016   0.46210569  0.46770717  0.6731456 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8975380177860673
Probability=0.00192
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼─────────────┼───────┤0     ├»
«                            │            │             │       │      │»
«    j_1: ───────────────────■────────────┼─────────────┼───────┤1     ├»
«                                         │             │       │  qft │»
«    j_2: ────────────────────────────────■─────────────┼───────┤2     ├»
«                                                       │       │      │»
«    j_3: ──────────────────────────────────────────────■───────┤3     ├»
«                                                               └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24972), ('11 0', 25067), ('10 1', 40), ('01 1', 36), ('01 0', 24971), ('11 1', 63), ('00 1', 23), ('10 0', 24828)]
Our simulation...
[-0.37679611  0.47140452  0.49690399  0.62360956]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8751326870289283
Probability=0.0016200000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├┤ RY(0.01145) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 24854), ('11 0', 25066), ('10 1', 23), ('01 1', 45), ('01 0', 25201), ('11 1', 43), ('00 1', 19), ('10 0', 24749)]
Our simulation...
[-0.38230073  0.58834841  0.42062225  0.5751254 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8108821807190006
Probability=0.0013000000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├┤ RY(0.010683) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼───────────────┼────────»
«                                │               │               │        »
«    j_1: ───────────────────────■───────────────┼───────────────┼────────»
«                                                │               │        »
«    j_2: ───────────────────────────────────────■───────────────┼────────»
«                                                                │        »
«    j_3: ───────────────────────────────────────────────────────■────────»
«                                                                         »
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 25080), ('11 0', 24915), ('10 1', 34), ('01 1', 25), ('01 0', 24986), ('11 1', 45), ('00 1', 24), ('10 0', 24891)]
Our simulation...
[-0.4330127   0.44194174  0.5153882   0.59292706]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8404198373240472
Probability=0.00128
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├┤ RY(0.0099678) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24982), ('11 0', 25022), ('10 1', 18), ('01 1', 30), ('01 0', 24748), ('11 1', 40), ('00 1', 16), ('10 0', 25144)]
Our simulation...
[-0.39223227  0.53708616  0.41602515  0.62017367]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8291662221778865
Probability=0.00104
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├┤ RY(0.0093003) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24959), ('11 0', 25039), ('10 1', 23), ('01 1', 27), ('01 0', 24977), ('11 1', 41), ('00 1', 12), ('10 0', 24922)]
Our simulation...
[-0.34132807  0.51199211  0.47254732  0.63091858]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8828346017767525
Probability=0.00103
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├┤ RY(0.0086775) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼────────────────┼────────»
«                               │              │                │        »
«    j_1: ──────────────────────■──────────────┼────────────────┼────────»
«                                              │                │        »
«    j_2: ─────────────────────────────────────■────────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24865), ('11 0', 25012), ('10 1', 21), ('01 1', 31), ('01 0', 24792), ('11 1', 33), ('00 1', 12), ('10 0', 25234)]
Our simulation...
[-0.35172623  0.56532082  0.46529007  0.58327197]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8509701005051975
Probability=0.00097
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├┤ RY(0.0080964) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 24683), ('11 0', 25013), ('10 1', 18), ('01 1', 16), ('01 0', 25109), ('11 1', 19), ('00 1', 6), ('10 0', 25136)]
Our simulation...
[-0.3188964   0.52075564  0.55234477  0.56748031]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8922342211095833
Probability=0.0005900000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├┤ RY(0.0075542) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 25004), ('11 0', 25019), ('10 1', 19), ('01 1', 13), ('01 0', 24896), ('11 1', 21), ('00 1', 10), ('10 0', 25018)]
Our simulation...
[-0.39840954  0.45425676  0.54916965  0.57735027]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8625083311550693
Probability=0.00063
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├┤ RY(0.0070483) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 25016), ('11 0', 25017), ('10 1', 15), ('01 1', 17), ('01 0', 24692), ('11 1', 14), ('00 1', 5), ('10 0', 25224)]
Our simulation...
[-0.31311215  0.57735027  0.54232614  0.52393683]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8631837720630714
Probability=0.0005099999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├┤ RY(0.0065763) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 0', 25068), ('11 0', 24882), ('10 1', 5), ('01 1', 11), ('01 0', 25145), ('11 1', 7), ('00 1', 7), ('10 0', 24875)]
Our simulation...
[-0.48304589  0.60553007  0.40824829  0.48304589]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7058960941310068
Probability=0.00030000000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=10.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├┤ RY(pi/512) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 0', 25172), ('11 0', 24911), ('10 1', 6), ('01 1', 8), ('01 0', 24915), ('11 1', 12), ('00 1', 9), ('10 0', 24967)]
Our simulation...
[-0.50709255  0.47809144  0.41403934  0.58554004]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7548422261751755
Probability=0.00035000000000000005
--------------------------------------------------
**************************************************
Max fidelity is 0.9169838509004454, when r=3.1
Min fidelity is 0.5953715931017333, when r=1.1
Choosing proper r=2.8, with fidelity=0.8599108485185836 and probability=0.42583.
Choosing proper r=2.9000000000000004, with fidelity=0.8936468396593984 and probability=0.40736999999999995.
Choosing proper r=3.0, with fidelity=0.9134234791299298 and probability=0.39123.
Choosing proper r=3.1, with fidelity=0.9169838509004454 and probability=0.38368.
Choosing proper r=3.2, with fidelity=0.9141512780251045 and probability=0.37258.
Choosing proper r=3.3000000000000003, with fidelity=0.9004716789724656 and probability=0.36758.
Choosing proper r=3.4000000000000004, with fidelity=0.8868112588012004 and probability=0.37126.
Choosing proper r=3.5, with fidelity=0.8663567115037232 and probability=0.38247000000000003.
Choosing proper r=3.6, with fidelity=0.8561869394126244 and probability=0.39443000000000006.
Choosing proper r=3.7, with fidelity=0.8455915295961923 and probability=0.411.
Choosing proper r=3.8000000000000003, with fidelity=0.8391888417423746 and probability=0.43293000000000004.
Choosing proper r=3.9000000000000004, with fidelity=0.8419982941738776 and probability=0.45158.
Choosing proper r=4.0, with fidelity=0.8409281731506383 and probability=0.46151.
Choosing proper r=4.1, with fidelity=0.8396768980896449 and probability=0.46626000000000006.
Choosing proper r=4.2, with fidelity=0.8388267582888227 and probability=0.4668.
Choosing proper r=4.300000000000001, with fidelity=0.8441215999384661 and probability=0.45804.
Choosing proper r=4.4, with fidelity=0.844670063403802 and probability=0.44556.
Choosing proper r=4.5, with fidelity=0.8456014753203525 and probability=0.42713.
Choosing proper r=4.6, with fidelity=0.8463618910005711 and probability=0.40348.
Choosing proper r=4.7, with fidelity=0.8428884198427609 and probability=0.37927.
Choosing proper r=4.800000000000001, with fidelity=0.8478996217059914 and probability=0.35097.
Choosing proper r=4.9, with fidelity=0.8445996620884761 and probability=0.32558.
Choosing proper r=5.0, with fidelity=0.8467554481457349 and probability=0.29479.
Choosing proper r=5.1000000000000005, with fidelity=0.8450808033336288 and probability=0.26769.
Choosing proper r=5.2, with fidelity=0.8457967741830327 and probability=0.24314000000000002.
Choosing proper r=5.3, with fidelity=0.8460721512889421 and probability=0.21797.
