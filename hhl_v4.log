--------------------------------------------------
Simulating with r=1.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌─────────┐┌────────┐                        »
«    s_0: ┤ RY(8pi) ├┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├────────────────────────»
«         └────┬────┘└────┬────┘└────┬────┘└───┬────┘┌──────┐                »
«    j_0: ─────■──────────┼──────────┼─────────┼─────┤0     ├────────────────»
«                         │          │         │     │      │                »
«    j_1: ────────────────■──────────┼─────────┼─────┤1     ├────────────────»
«                                    │         │     │  qft │                »
«    j_2: ───────────────────────────■─────────┼─────┤2     ├────────────────»
«                                              │     │      │                »
«    j_3: ─────────────────────────────────────■─────┤3     ├───────■────────»
«                                                    └──────┘┌──────┴───────┐»
«    q_0: ───────────────────────────────────────────────────┤0             ├»
«                                                            │  gate_1/2_dg │»
«    q_1: ───────────────────────────────────────────────────┤1             ├»
«                                                            └──────────────┘»
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('00 1', 3220), ('10 1', 4481), ('11 1', 1023), ('10 0', 24594), ('01 0', 2779), ('11 0', 10578), ('00 0', 52506), ('01 1', 819)]
Our simulation...
[-0.58087873  0.29295404  0.68524363  0.32741257]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6120527892157915
Probability=0.09543
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(23.45) ├┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 13720), ('10 1', 12246), ('11 1', 4690), ('10 0', 17224), ('01 0', 3520), ('11 0', 9287), ('00 0', 35490), ('01 1', 3823)]
Our simulation...
[-0.63081168  0.33298511  0.59596368  0.36881544]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6024433246711206
Probability=0.34479
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(21.879) ├┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├────────»
«         └─────┬──────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼────────────┼─────────────┼───────┤0     ├»
«                             │            │             │       │      │»
«    j_1: ────────────────────■────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 15627), ('10 1', 15085), ('11 1', 6519), ('10 0', 15421), ('01 0', 7264), ('11 0', 12477), ('00 0', 20048), ('01 1', 7559)]
Our simulation...
[-0.59067321  0.4108106   0.58033949  0.38150476]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6450751367207865
Probability=0.4479
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(20.414) ├┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 7746), ('10 1', 13107), ('11 1', 5952), ('10 0', 19112), ('01 0', 11695), ('11 0', 17512), ('00 0', 15115), ('01 1', 9761)]
Our simulation...
[-0.46025659  0.51666427  0.59870505  0.4034528 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7442649928808134
Probability=0.36566
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(19.047) ├┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6544), ('10 1', 16460), ('11 1', 6185), ('10 0', 17379), ('01 0', 17254), ('11 0', 18969), ('00 0', 10157), ('01 1', 7052)]
Our simulation...
[-0.42493408  0.44111931  0.67393006  0.41311386]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7811037139815138
Probability=0.36241
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(17.772) ├┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 8910), ('10 1', 19411), ('11 1', 8056), ('10 0', 15635), ('01 0', 19336), ('11 0', 17004), ('00 0', 7345), ('01 1', 4303)]
Our simulation...
[-0.46800272  0.32523345  0.69077002  0.44500947]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.765058268655289
Probability=0.40680000000000005
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(16.581) ├┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 10291), ('10 1', 21105), ('11 1', 10185), ('10 0', 14182), ('01 0', 14938), ('11 0', 13544), ('00 0', 10013), ('01 1', 5742)]
Our simulation...
[-0.46632925  0.34833367  0.66781558  0.46392137]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7796792932098218
Probability=0.47323000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(15.471) ├┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 9243), ('10 1', 23181), ('11 1', 9769), ('10 0', 11293), ('01 0', 9647), ('11 0', 13332), ('00 0', 16234), ('01 1', 7301)]
Our simulation...
[-0.4321457   0.38407399  0.68436818  0.44427183]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7933997118570492
Probability=0.49494
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(14.435) ├┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 8464), ('10 1', 22974), ('11 1', 7507), ('10 0', 9404), ('01 0', 7059), ('11 0', 16155), ('00 0', 21342), ('01 1', 7095)]
Our simulation...
[-0.42876583  0.39256226  0.70639994  0.40379929]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7715480676538734
Probability=0.4604
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(13.468) ├┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 9783), ('10 1', 19354), ('11 1', 8242), ('10 0', 11042), ('01 0', 5791), ('11 0', 16638), ('00 0', 22910), ('01 1', 6240)]
Our simulation...
[-0.47358526  0.37822867  0.6661124   0.4346888 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7623233254678135
Probability=0.43619
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌────────┐┌──────────┐                        »
«    s_0: ┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├────────────────────────»
«         └────┬────┘└────┬────┘└───┬────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■──────────┼─────────┼──────────┼──────┤0     ├────────────────»
«                         │         │          │      │      │                »
«    j_1: ────────────────■─────────┼──────────┼──────┤1     ├────────────────»
«                                   │          │      │  qft │                »
«    j_2: ──────────────────────────■──────────┼──────┤2     ├────────────────»
«                                              │      │      │                »
«    j_3: ─────────────────────────────────────■──────┤3     ├───────■────────»
«                                                     └──────┘┌──────┴───────┐»
«    q_0: ────────────────────────────────────────────────────┤0             ├»
«                                                             │  gate_1/2_dg │»
«    q_1: ────────────────────────────────────────────────────┤1             ├»
«                                                             └──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('00 1', 10807), ('10 1', 14022), ('11 1', 12303), ('10 0', 14176), ('01 0', 5504), ('11 0', 14350), ('00 0', 22674), ('01 1', 6164)]
Our simulation...
[-0.4996072   0.37731792  0.56909018  0.53306679]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7843868508778106
Probability=0.43296
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 10221), ('10 1', 9714), ('11 1', 17404), ('10 0', 16610), ('01 0', 5972), ('11 0', 11365), ('00 0', 22091), ('01 1', 6623)]
Our simulation...
[-0.48217865  0.38814023  0.47006761  0.6291958 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8055419861001729
Probability=0.43962
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 9427), ('10 1', 7463), ('11 1', 20441), ('10 0', 17428), ('01 0', 6612), ('11 0', 10155), ('00 0', 20310), ('01 1', 8164)]
Our simulation...
[-0.45520279  0.42361337  0.40501852  0.67030002]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8094554233380564
Probability=0.45495
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 9497), ('10 1', 6946), ('11 1', 20666), ('10 0', 16657), ('01 0', 7298), ('11 0', 11589), ('00 0', 16572), ('01 1', 10775)]
Our simulation...
[-0.44534646  0.47436586  0.38086598  0.65695104]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8003273798730112
Probability=0.47884000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 10275), ('10 1', 6741), ('11 1', 19153), ('10 0', 16061), ('01 0', 8574), ('11 0', 13844), ('00 0', 12016), ('01 1', 13336)]
Our simulation...
[-0.45558182  0.51902498  0.36900957  0.62200499]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7751187719929815
Probability=0.49505
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 10287), ('10 1', 6757), ('11 1', 18093), ('10 0', 15056), ('01 0', 11190), ('11 0', 15629), ('00 0', 8301), ('01 1', 14687)]
Our simulation...
[-0.45438614  0.54293427  0.36826264  0.60260953]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7661505107097983
Probability=0.49824
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 9192), ('10 1', 6655), ('11 1', 18000), ('10 0', 14667), ('01 0', 15577), ('11 0', 15817), ('00 0', 6216), ('01 1', 13876)]
Our simulation...
[-0.4388753   0.53922284  0.37343082  0.61414707]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.781928921621805
Probability=0.47723
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 7463), ('10 1', 6501), ('11 1', 18898), ('10 0', 14235), ('01 0', 20316), ('11 0', 14724), ('00 0', 5638), ('01 1', 12225)]
Our simulation...
[-0.40684694  0.52071341  0.37972082  0.64741425]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8148858477159737
Probability=0.45087
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 5531), ('10 1', 6690), ('11 1', 20092), ('10 0', 13506), ('01 0', 24931), ('11 0', 13256), ('00 0', 5650), ('01 1', 10344)]
Our simulation...
[-0.36008636  0.49243521  0.39602072  0.68630384]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8585524738463316
Probability=0.42657
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 4193), ('10 1', 7148), ('11 1', 20689), ('10 0', 12801), ('01 0', 28231), ('11 0', 12087), ('00 0', 6120), ('01 1', 8731)]
Our simulation...
[-0.32073032  0.46281729  0.4187645   0.71243842]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8933962271188881
Probability=0.40761000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌────────┐┌──────────┐┌──────────┐                        »
«    s_0: ┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├────────────────────────»
«         └────┬────┘└───┬────┘└────┬─────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■─────────┼──────────┼───────────┼──────┤0     ├────────────────»
«                        │          │           │      │      │                »
«    j_1: ───────────────■──────────┼───────────┼──────┤1     ├────────────────»
«                                   │           │      │  qft │                »
«    j_2: ──────────────────────────■───────────┼──────┤2     ├────────────────»
«                                               │      │      │                »
«    j_3: ──────────────────────────────────────■──────┤3     ├───────■────────»
«                                                      └──────┘┌──────┴───────┐»
«    q_0: ─────────────────────────────────────────────────────┤0             ├»
«                                                              │  gate_1/2_dg │»
«    q_1: ─────────────────────────────────────────────────────┤1             ├»
«                                                              └──────────────┘»
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('00 1', 3506), ('10 1', 7825), ('11 1', 20659), ('10 0', 12031), ('01 0', 30528), ('11 0', 11605), ('00 0', 6119), ('01 1', 7727)]
Our simulation...
[-0.29711032  0.44107987  0.44386812  0.72121779]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9155212134331971
Probability=0.39716999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 3512), ('10 1', 8203), ('11 1', 19193), ('10 0', 11446), ('01 0', 31819), ('11 0', 12255), ('00 0', 6256), ('01 1', 7316)]
Our simulation...
[-0.30311623  0.43749066  0.46325305  0.70860362]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9186510058370503
Probability=0.38224
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 3757), ('10 1', 8573), ('11 1', 17522), ('10 0', 10926), ('01 0', 32274), ('11 0', 13396), ('00 0', 6224), ('01 1', 7328)]
Our simulation...
[-0.31788198  0.44395407  0.48018846  0.68649463]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9143813842928035
Probability=0.3718
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 4292), ('10 1', 8826), ('11 1', 16020), ('10 0', 10659), ('01 0', 31416), ('11 0', 14508), ('00 0', 6426), ('01 1', 7853)]
Our simulation...
[-0.34062916  0.46075469  0.48846553  0.65808686]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9001344278486317
Probability=0.36991
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 4789), ('10 1', 9191), ('11 1', 14394), ('10 0', 10522), ('01 0', 30349), ('11 0', 15418), ('00 0', 6814), ('01 1', 8523)]
Our simulation...
[-0.360269    0.48061876  0.49909803  0.62459028]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8837640235829111
Probability=0.36897
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 5252), ('10 1', 9641), ('11 1', 13516), ('10 0', 10320), ('01 0', 29000), ('11 0', 15804), ('00 0', 7031), ('01 1', 9436)]
Our simulation...
[-0.3725273   0.49933236  0.50472729  0.59761273]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8689868039924226
Probability=0.37845
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 5754), ('10 1', 10140), ('11 1', 13101), ('10 0', 10114), ('01 0', 26878), ('11 0', 15906), ('00 0', 7559), ('01 1', 10548)]
Our simulation...
[-0.38146098  0.51647613  0.50638889  0.57559553]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8549886616364306
Probability=0.39543
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6198), ('10 1', 10449), ('11 1', 13349), ('10 0', 9857), ('01 0', 25558), ('11 0', 15348), ('00 0', 8074), ('01 1', 11167)]
Our simulation...
[-0.38803623  0.52085249  0.5038298   0.56947001]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.847925433326599
Probability=0.41163
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6661), ('10 1', 10753), ('11 1', 13571), ('10 0', 10001), ('01 0', 23801), ('11 0', 14583), ('00 0', 8633), ('01 1', 11997)]
Our simulation...
[-0.39366464  0.5283151   0.50017446  0.56190464]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8398852358428872
Probability=0.42982
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6918), ('10 1', 11093), ('11 1', 14276), ('10 0', 10295), ('01 0', 22041), ('11 0', 13354), ('00 0', 9470), ('01 1', 12553)]
Our simulation...
[-0.39278734  0.5291039   0.49738388  0.56424857]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.840324563049351
Probability=0.4484
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────┐┌──────────┐┌──────────┐┌──────────┐        »
«    s_0: ┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├────────»
«         └───┬────┘└────┬─────┘└────┬─────┘└────┬─────┘┌──────┐»
«    j_0: ────■──────────┼───────────┼───────────┼──────┤0     ├»
«                        │           │           │      │      │»
«    j_1: ───────────────■───────────┼───────────┼──────┤1     ├»
«                                    │           │      │  qft │»
«    j_2: ───────────────────────────■───────────┼──────┤2     ├»
«                                                │      │      │»
«    j_3: ───────────────────────────────────────■──────┤3     ├»
«                                                       └──────┘»
«    q_0: ──────────────────────────────────────────────────────»
«                                                               »
«    q_1: ──────────────────────────────────────────────────────»
«                                                               »
«   cr_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_1: ══════════════════════════════════════════════════════»
«                                                               »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 7050), ('10 1', 11228), ('11 1', 14958), ('10 0', 10070), ('01 0', 20796), ('11 0', 12752), ('00 0', 10054), ('01 1', 13092)]
Our simulation...
[-0.39009715  0.53159541  0.49229954  0.568218  ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8413614543075411
Probability=0.46328
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 7077), ('10 1', 11315), ('11 1', 15373), ('10 0', 10622), ('01 0', 20098), ('11 0', 11810), ('00 0', 10823), ('01 1', 12882)]
Our simulation...
[-0.38950473  0.52550855  0.49251042  0.57407344]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8448711502295979
Probability=0.46647
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 7133), ('10 1', 10992), ('11 1', 15504), ('10 0', 11082), ('01 0', 19168), ('11 0', 11373), ('00 0', 11681), ('01 1', 13067)]
Our simulation...
[-0.39083754  0.52899078  0.48517512  0.57621166]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8421632322691294
Probability=0.46696000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 7165), ('10 1', 10730), ('11 1', 15254), ('10 0', 11617), ('01 0', 18590), ('11 0', 11401), ('00 0', 12504), ('01 1', 12739)]
Our simulation...
[-0.39514686  0.52688775  0.48355992  0.57655708]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8398069648421285
Probability=0.45888
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6893), ('10 1', 10195), ('11 1', 15061), ('10 0', 12472), ('01 0', 18206), ('11 0', 11613), ('00 0', 13369), ('01 1', 12191)]
Our simulation...
[-0.3942814   0.52435066  0.4795079   0.58281277]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8416097095159041
Probability=0.4434
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6520), ('10 1', 9587), ('11 1', 14809), ('10 0', 13221), ('01 0', 18345), ('11 0', 11543), ('00 0', 14236), ('01 1', 11739)]
Our simulation...
[-0.39096585  0.52460277  0.47408519  0.58922056]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8438102736037432
Probability=0.42655
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 6219), ('10 1', 9149), ('11 1', 13887), ('10 0', 14058), ('01 0', 18421), ('11 0', 12216), ('00 0', 14975), ('01 1', 11075)]
Our simulation...
[-0.39268668  0.52403194  0.47629136  0.5868    ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8428665518734582
Probability=0.4033
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 5570), ('10 1', 8580), ('11 1', 13253), ('10 0', 14906), ('01 0', 18606), ('11 0', 12764), ('00 0', 16068), ('01 1', 10253)]
Our simulation...
[-0.38460108  0.52180518  0.4773386   0.59325309]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8500252024828823
Probability=0.37656
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 5415), ('10 1', 7730), ('11 1', 12388), ('10 0', 15762), ('01 0', 19103), ('11 0', 13533), ('00 0', 16628), ('01 1', 9441)]
Our simulation...
[-0.39348355  0.51956076  0.47012906  0.59515207]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8438915512046886
Probability=0.34974
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 5162), ('10 1', 7293), ('11 1', 11522), ('10 0', 16614), ('01 0', 19198), ('11 0', 14104), ('00 0', 17437), ('01 1', 8670)]
Our simulation...
[-0.39763752  0.51533295  0.47264108  0.59407639]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8427169847246131
Probability=0.32647
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌──────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├────────»
«         └────┬─────┘└────┬─────┘└────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼───────────┼────────────┼──────┤0     ├»
«                          │           │            │      │      │»
«    j_1: ─────────────────■───────────┼────────────┼──────┤1     ├»
«                                      │            │      │  qft │»
«    j_2: ─────────────────────────────■────────────┼──────┤2     ├»
«                                                   │      │      │»
«    j_3: ──────────────────────────────────────────■──────┤3     ├»
«                                                          └──────┘»
«    q_0: ─────────────────────────────────────────────────────────»
«                                                                  »
«    q_1: ─────────────────────────────────────────────────────────»
«                                                                  »
«   cr_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_1: ═════════════════════════════════════════════════════════»
«                                                                  »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 4472), ('10 1', 6523), ('11 1', 10610), ('10 0', 17303), ('01 0', 19902), ('11 0', 15223), ('00 0', 18075), ('01 1', 7892)]
Our simulation...
[-0.38936954  0.5172549   0.47025645  0.59974794]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8479710239789374
Probability=0.29497
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 4107), ('10 1', 5858), ('11 1', 9633), ('10 0', 17828), ('01 0', 20147), ('11 0', 16138), ('00 0', 19049), ('01 1', 7240)]
Our simulation...
[-0.39118958  0.51939075  0.46719653  0.59910881]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8454562066586229
Probability=0.26838
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 3595), ('10 1', 5396), ('11 1', 8818), ('10 0', 18825), ('01 0', 20519), ('11 0', 16829), ('00 0', 19547), ('01 1', 6471)]
Our simulation...
[-0.38479118  0.51625154  0.47142394  0.60264382]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.851859503434822
Probability=0.24280000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 3316), ('10 1', 4747), ('11 1', 7818), ('10 0', 19424), ('01 0', 20914), ('11 0', 17708), ('00 0', 20078), ('01 1', 5995)]
Our simulation...
[-0.38933487  0.52349271  0.46582807  0.59781096]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8449510368613404
Probability=0.21876
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 3006), ('10 1', 4309), ('11 1', 7117), ('10 0', 19992), ('01 0', 21397), ('11 0', 18226), ('00 0', 20749), ('01 1', 5204)]
Our simulation...
[-0.39126228  0.51480426  0.46844837  0.60203532]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8474302819325713
Probability=0.19636
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 2651), ('10 1', 3828), ('11 1', 6335), ('10 0', 20590), ('01 0', 21950), ('11 0', 18890), ('00 0', 21147), ('01 1', 4609)]
Our simulation...
[-0.39007076  0.51433003  0.46873188  0.6029924 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8485339305530494
Probability=0.17423
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 2360), ('10 1', 3386), ('11 1', 5561), ('10 0', 21191), ('01 0', 22326), ('11 0', 19656), ('00 0', 21342), ('01 1', 4178)]
Our simulation...
[-0.39039154  0.51943189  0.4676144   0.59926766]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8460698287848872
Probability=0.15485
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 2078), ('10 1', 3032), ('11 1', 5049), ('10 0', 21254), ('01 0', 22483), ('11 0', 20342), ('00 0', 22093), ('01 1', 3669)]
Our simulation...
[-0.38765294  0.51510311  0.46825768  0.60425882]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8499573923194141
Probability=0.13828000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 1888), ('10 1', 2638), ('11 1', 4493), ('10 0', 22188), ('01 0', 22504), ('11 0', 20853), ('00 0', 22311), ('01 1', 3125)]
Our simulation...
[-0.39429395  0.50727578  0.46607576  0.6082573 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8479415187273862
Probability=0.12143999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 1657), ('10 1', 2284), ('11 1', 3842), ('10 0', 22106), ('01 0', 23178), ('11 0', 21430), ('00 0', 22647), ('01 1', 2856)]
Our simulation...
[-0.39464886  0.51811802  0.46333771  0.60093607]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8430501391496494
Probability=0.10639000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├────────»
«         └────┬─────┘└────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼────────────┼────────────┼──────┤0     ├»
«                          │            │            │      │      │»
«    j_1: ─────────────────■────────────┼────────────┼──────┤1     ├»
«                                       │            │      │  qft │»
«    j_2: ──────────────────────────────■────────────┼──────┤2     ├»
«                                                    │      │      │»
«    j_3: ───────────────────────────────────────────■──────┤3     ├»
«                                                           └──────┘»
«    q_0: ──────────────────────────────────────────────────────────»
«                                                                   »
«    q_1: ──────────────────────────────────────────────────────────»
«                                                                   »
«   cr_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_1: ══════════════════════════════════════════════════════════»
«                                                                   »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 1476), ('10 1', 2050), ('11 1', 3353), ('10 0', 22573), ('01 0', 23420), ('11 0', 21675), ('00 0', 22970), ('01 1', 2483)]
Our simulation...
[-0.39706249  0.51499622  0.46794263  0.59845632]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8429483995691703
Probability=0.09362
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 1266), ('10 1', 1740), ('11 1', 3147), ('10 0', 22853), ('01 0', 23214), ('11 0', 22248), ('00 0', 23325), ('01 1', 2207)]
Our simulation...
[-0.38914702  0.51380465  0.45621702  0.61354332]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8480241465536219
Probability=0.0836
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 1089), ('10 1', 1592), ('11 1', 2765), ('10 0', 23220), ('01 0', 23640), ('11 0', 22447), ('00 0', 23252), ('01 1', 1995)]
Our simulation...
[-0.38255888  0.51779255  0.46254701  0.60958169]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8519697262891355
Probability=0.07441
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 970), ('10 1', 1427), ('11 1', 2389), ('10 0', 23348), ('01 0', 23869), ('11 0', 22625), ('00 0', 23739), ('01 1', 1633)]
Our simulation...
[-0.38873369  0.5043818   0.47149631  0.61006258]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8536718791573642
Probability=0.06419
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 833), ('10 1', 1210), ('11 1', 2127), ('10 0', 23590), ('01 0', 24108), ('11 0', 22833), ('00 0', 23764), ('01 1', 1535)]
Our simulation...
[-0.38211552  0.51871208  0.46053735  0.61059876]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8516803217124236
Probability=0.057050000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 746), ('10 1', 1070), ('11 1', 1812), ('10 0', 23866), ('01 0', 23797), ('11 0', 23417), ('00 0', 23931), ('01 1', 1361)]
Our simulation...
[-0.38668975  0.52230275  0.46311104  0.60265997]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8471633756329646
Probability=0.049890000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 630), ('10 1', 935), ('11 1', 1591), ('10 0', 23935), ('01 0', 24101), ('11 0', 23355), ('00 0', 24283), ('01 1', 1170)]
Our simulation...
[-0.38161639  0.52005548  0.46490321  0.60644558]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8519744003804866
Probability=0.04326000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 557), ('10 1', 816), ('11 1', 1430), ('10 0', 24108), ('01 0', 24039), ('11 0', 23673), ('00 0', 24388), ('01 1', 989)]
Our simulation...
[-0.38325995  0.51069779  0.46388563  0.61409259]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8544147176011614
Probability=0.037919999999999995
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 503), ('10 1', 713), ('11 1', 1243), ('10 0', 24246), ('01 0', 24419), ('11 0', 23868), ('00 0', 24162), ('01 1', 846)]
Our simulation...
[-0.39012004  0.5059405   0.46447146  0.61326733]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.851337022450297
Probability=0.03305
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 435), ('10 1', 621), ('11 1', 1078), ('10 0', 24400), ('01 0', 24087), ('11 0', 24324), ('00 0', 24247), ('01 1', 808)]
Our simulation...
[-0.38452386  0.52406402  0.45943541  0.60532421]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.847599329334586
Probability=0.029419999999999998
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌───────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├────────»
«         └────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■────────────┼────────────┼────────────┼──────┤0     ├»
«                           │            │            │      │      │»
«    j_1: ──────────────────■────────────┼────────────┼──────┤1     ├»
«                                        │            │      │  qft │»
«    j_2: ───────────────────────────────■────────────┼──────┤2     ├»
«                                                     │      │      │»
«    j_3: ────────────────────────────────────────────■──────┤3     ├»
«                                                            └──────┘»
«    q_0: ───────────────────────────────────────────────────────────»
«                                                                    »
«    q_1: ───────────────────────────────────────────────────────────»
«                                                                    »
«   cr_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_1: ═══════════════════════════════════════════════════════════»
«                                                                    »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 378), ('10 1', 547), ('11 1', 905), ('10 0', 24246), ('01 0', 24650), ('11 0', 24219), ('00 0', 24415), ('01 1', 640)]
Our simulation...
[-0.39119872  0.50902781  0.4705927   0.60530716]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8499906212339732
Probability=0.0247
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 342), ('10 1', 486), ('11 1', 836), ('10 0', 24416), ('01 0', 24535), ('11 0', 24271), ('00 0', 24562), ('01 1', 552)]
Our simulation...
[-0.39285128  0.49909666  0.46830981  0.61421195]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8522706279904265
Probability=0.02216
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 316), ('10 1', 423), ('11 1', 667), ('10 0', 24496), ('01 0', 24892), ('11 0', 24131), ('00 0', 24566), ('01 1', 509)]
Our simulation...
[-0.40621799  0.51555441  0.46998694  0.5901719 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8357789770349463
Probability=0.01915
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 253), ('10 1', 385), ('11 1', 586), ('10 0', 24636), ('01 0', 24631), ('11 0', 24529), ('00 0', 24525), ('01 1', 455)]
Our simulation...
[-0.38818157  0.52057145  0.47885609  0.59077684]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8479709779943337
Probability=0.01679
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 222), ('10 1', 295), ('11 1', 566), ('10 0', 24737), ('01 0', 24739), ('11 0', 24579), ('00 0', 24456), ('01 1', 406)]
Our simulation...
[-0.38612608  0.52217451  0.44510622  0.61653944]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8452595082872661
Probability=0.01489
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 171), ('10 1', 274), ('11 1', 503), ('10 0', 24672), ('01 0', 24897), ('11 0', 24453), ('00 0', 24689), ('01 1', 341)]
Our simulation...
[-0.36422655  0.51434051  0.46105085  0.6246799 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8657733192465793
Probability=0.012889999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 169), ('10 1', 225), ('11 1', 388), ('10 0', 24709), ('01 0', 24721), ('11 0', 24765), ('00 0', 24704), ('01 1', 319)]
Our simulation...
[-0.3917867   0.53827187  0.45206158  0.5936387 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8350334906764548
Probability=0.01101
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 149), ('10 1', 201), ('11 1', 387), ('10 0', 24662), ('01 0', 24823), ('11 0', 24867), ('00 0', 24659), ('01 1', 252)]
Our simulation...
[-0.38814589  0.50477998  0.45081658  0.62554324]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8512655035250944
Probability=0.00989
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 142), ('10 1', 195), ('11 1', 330), ('10 0', 24911), ('01 0', 24718), ('11 0', 24727), ('00 0', 24751), ('01 1', 226)]
Our simulation...
[-0.39876629  0.50307008  0.46729548  0.60789874]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.846323052139864
Probability=0.00893
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 121), ('10 1', 174), ('11 1', 263), ('10 0', 24927), ('01 0', 24831), ('11 0', 24679), ('00 0', 24833), ('01 1', 172)]
Our simulation...
[-0.40712827  0.48540338  0.48821733  0.60022827]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8478323877811278
Probability=0.0073
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌───────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼────────────┼───────┤0     ├»
«                            │            │            │       │      │»
«    j_1: ───────────────────■────────────┼────────────┼───────┤1     ├»
«                                         │            │       │  qft │»
«    j_2: ────────────────────────────────■────────────┼───────┤2     ├»
«                                                      │       │      │»
«    j_3: ─────────────────────────────────────────────■───────┤3     ├»
«                                                              └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────»
«                                                                      »
«    q_1: ─────────────────────────────────────────────────────────────»
«                                                                      »
«   cr_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_1: ═════════════════════════════════════════════════════════════»
«                                                                      »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 105), ('10 1', 119), ('11 1', 231), ('10 0', 25032), ('01 0', 24722), ('11 0', 24871), ('00 0', 24738), ('01 1', 182)]
Our simulation...
[-0.40599897  0.53452248  0.43221891  0.60219379]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8232718524947346
Probability=0.006370000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 83), ('10 1', 124), ('11 1', 221), ('10 0', 24974), ('01 0', 24717), ('11 0', 24778), ('00 0', 24968), ('01 1', 135)]
Our simulation...
[-0.383959    0.48968036  0.46930658  0.6265301 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8619401605340895
Probability=0.00563
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 86), ('10 1', 115), ('11 1', 203), ('10 0', 24920), ('01 0', 24743), ('11 0', 24866), ('00 0', 24943), ('01 1', 124)]
Our simulation...
[-0.40358244  0.48461168  0.46669372  0.6200562 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8490228649166405
Probability=0.00528
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 68), ('10 1', 87), ('11 1', 159), ('10 0', 24854), ('01 0', 24940), ('11 0', 24993), ('00 0', 24785), ('01 1', 114)]
Our simulation...
[-0.39859567  0.51609606  0.45085588  0.60950416]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8394565927714284
Probability=0.004280000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 49), ('10 1', 66), ('11 1', 126), ('10 0', 24811), ('01 0', 25003), ('11 0', 24998), ('00 0', 24860), ('01 1', 87)]
Our simulation...
[-0.38651034  0.51501835  0.44857498  0.6197954 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8483312012860237
Probability=0.00328
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 61), ('10 1', 66), ('11 1', 122), ('10 0', 25072), ('01 0', 24845), ('11 0', 24734), ('00 0', 25012), ('01 1', 88)]
Our simulation...
[-0.42545141  0.51100645  0.44254457  0.60167915]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8195100269205561
Probability=0.00337
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 39), ('10 1', 44), ('11 1', 109), ('10 0', 24858), ('01 0', 25112), ('11 0', 24866), ('00 0', 24906), ('01 1', 66)]
Our simulation...
[-0.38879659  0.50578054  0.41296808  0.64998509]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8421895700891304
Probability=0.00258
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 38), ('10 1', 47), ('11 1', 92), ('10 0', 25000), ('01 0', 24781), ('11 0', 25101), ('00 0', 24880), ('01 1', 61)]
Our simulation...
[-0.39957961  0.50626329  0.44438608  0.62173517]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.841444317565283
Probability=0.00238
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 30), ('10 1', 57), ('11 1', 91), ('10 0', 24797), ('01 0', 24976), ('11 0', 24893), ('00 0', 25107), ('01 1', 49)]
Our simulation...
[-0.36353623  0.46460632  0.50110011  0.63315169]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8862641123671134
Probability=0.00227
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 27), ('10 1', 36), ('11 1', 54), ('10 0', 25005), ('01 0', 24786), ('11 0', 24899), ('00 0', 25135), ('01 1', 58)]
Our simulation...
[-0.3927922   0.57569833  0.45355737  0.55549206]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8137165304616755
Probability=0.00175
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼─────────────┼───────┤0     ├»
«                            │            │             │       │      │»
«    j_1: ───────────────────■────────────┼─────────────┼───────┤1     ├»
«                                         │             │       │  qft │»
«    j_2: ────────────────────────────────■─────────────┼───────┤2     ├»
«                                                       │       │      │»
«    j_3: ──────────────────────────────────────────────■───────┤3     ├»
«                                                               └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 20), ('10 1', 45), ('11 1', 56), ('10 0', 25258), ('01 0', 24749), ('11 0', 24948), ('00 0', 24881), ('01 1', 43)]
Our simulation...
[-0.34921515  0.51204992  0.52382272  0.58434871]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.879465806811516
Probability=0.00164
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├┤ RY(0.01145) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 30), ('10 1', 34), ('11 1', 57), ('10 0', 24946), ('01 0', 25052), ('11 0', 24813), ('00 0', 25034), ('01 1', 34)]
Our simulation...
[-0.43994135  0.46835333  0.46835333  0.60641729]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8255509908758062
Probability=0.00155
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├┤ RY(0.010683) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼───────────────┼────────»
«                                │               │               │        »
«    j_1: ───────────────────────■───────────────┼───────────────┼────────»
«                                                │               │        »
«    j_2: ───────────────────────────────────────■───────────────┼────────»
«                                                                │        »
«    j_3: ───────────────────────────────────────────────────────■────────»
«                                                                         »
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 18), ('10 1', 31), ('11 1', 41), ('10 0', 24961), ('01 0', 24936), ('11 0', 24911), ('00 0', 25068), ('01 1', 34)]
Our simulation...
[-0.38100038  0.52363494  0.5         0.57501753]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8521686669462131
Probability=0.00124
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├┤ RY(0.0099678) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 10), ('10 1', 20), ('11 1', 43), ('10 0', 25169), ('01 0', 24746), ('11 0', 25085), ('00 0', 24895), ('01 1', 32)]
Our simulation...
[-0.3086067   0.55205245  0.43643578  0.63994047]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8795518431721228
Probability=0.00105
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├┤ RY(0.0093003) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 9), ('10 1', 26), ('11 1', 31), ('10 0', 24964), ('01 0', 24999), ('11 0', 24952), ('00 0', 25006), ('01 1', 13)]
Our simulation...
[-0.33752637  0.40565621  0.57368452  0.62642243]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9142857002047708
Probability=0.00079
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├┤ RY(0.0086775) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼────────────────┼────────»
«                               │              │                │        »
«    j_1: ──────────────────────■──────────────┼────────────────┼────────»
«                                              │                │        »
«    j_2: ─────────────────────────────────────■────────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 14), ('10 1', 29), ('11 1', 26), ('10 0', 25130), ('01 0', 24793), ('11 0', 24981), ('00 0', 25010), ('01 1', 17)]
Our simulation...
[-0.40347329  0.44460591  0.58069726  0.54984141]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8551400361294047
Probability=0.00086
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├┤ RY(0.0080964) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 8), ('10 1', 8), ('11 1', 28), ('10 0', 25013), ('01 0', 24954), ('11 0', 25008), ('00 0', 24956), ('01 1', 25)]
Our simulation...
[-0.34050261  0.60192927  0.34050261  0.63702206]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8085990873665062
Probability=0.00069
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├┤ RY(0.0075542) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 5), ('10 1', 11), ('11 1', 21), ('10 0', 25071), ('01 0', 24828), ('11 0', 24960), ('00 0', 25087), ('01 1', 17)]
Our simulation...
[-0.30429031  0.56108361  0.45133547  0.62360956]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8806199043679449
Probability=0.00054
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├┤ RY(0.0070483) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 11), ('10 1', 11), ('11 1', 22), ('10 0', 24998), ('01 0', 24797), ('11 0', 25156), ('00 0', 24993), ('01 1', 12)]
Our simulation...
[-0.44320263  0.46291005  0.44320263  0.62678317]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.820950839001509
Probability=0.0005600000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├┤ RY(0.0065763) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('00 1', 5), ('10 1', 14), ('11 1', 24), ('10 0', 24941), ('01 0', 25169), ('11 0', 25018), ('00 0', 24818), ('01 1', 11)]
Our simulation...
[-0.30429031  0.45133547  0.50917508  0.66666667]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9246957532875321
Probability=0.00054
--------------------------------------------------
--------------------------------------------------
Simulating with r=10.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├┤ RY(pi/512) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('00 1', 4), ('10 1', 10), ('11 1', 21), ('10 0', 25122), ('01 0', 25073), ('11 0', 24998), ('00 0', 24761), ('01 1', 11)]
Our simulation...
[-0.29488391  0.48900965  0.4662524   0.67566392]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9142045740957249
Probability=0.00046000000000000007
--------------------------------------------------
**************************************************
Max fidelity is 0.9246957532875321, when r=9.9
Min fidelity is 0.6024433246711206, when r=1.1
1.3126912134331972
