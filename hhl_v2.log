--------------------------------------------------
Simulating with r=1.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌─────────┐┌────────┐                        »
«    s_0: ┤ RY(8pi) ├┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├────────────────────────»
«         └────┬────┘└────┬────┘└────┬────┘└───┬────┘┌──────┐                »
«    j_0: ─────■──────────┼──────────┼─────────┼─────┤0     ├────────────────»
«                         │          │         │     │      │                »
«    j_1: ────────────────■──────────┼─────────┼─────┤1     ├────────────────»
«                                    │         │     │  qft │                »
«    j_2: ───────────────────────────■─────────┼─────┤2     ├────────────────»
«                                              │     │      │                »
«    j_3: ─────────────────────────────────────■─────┤3     ├───────■────────»
«                                                    └──────┘┌──────┴───────┐»
«    q_0: ───────────────────────────────────────────────────┤0             ├»
«                                                            │  gate_1/2_dg │»
«    q_1: ───────────────────────────────────────────────────┤1             ├»
«                                                            └──────────────┘»
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('01 0', 2818), ('10 0', 24512), ('11 0', 10345), ('00 1', 3278), ('10 1', 4489), ('00 0', 52750), ('11 1', 1019), ('01 1', 789)]
Our simulation...
[-0.58510672  0.28705764  0.68470801  0.32622535]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6071095186574587
Probability=0.09574999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(23.45) ├┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 3389), ('10 0', 17408), ('11 0', 9201), ('00 1', 13885), ('10 1', 12236), ('00 0', 35531), ('11 1', 4528), ('01 1', 3822)]
Our simulation...
[-0.63466712  0.33298019  0.59578943  0.36243178]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.5956364356120037
Probability=0.34470999999999996
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(21.879) ├┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├────────»
«         └─────┬──────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼────────────┼─────────────┼───────┤0     ├»
«                             │            │             │       │      │»
«    j_1: ────────────────────■────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 7358), ('10 0', 15570), ('11 0', 12324), ('00 1', 15554), ('10 1', 15147), ('00 0', 19928), ('11 1', 6502), ('01 1', 7617)]
Our simulation...
[-0.58909471  0.41224562  0.58133623  0.38087946]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.646060080547076
Probability=0.4482
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(20.414) ├┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 11786), ('10 0', 19228), ('11 0', 17391), ('00 1', 7780), ('10 1', 12961), ('00 0', 15357), ('11 1', 5883), ('01 1', 9614)]
Our simulation...
[-0.46334842  0.51507438  0.59804952  0.4029186 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.742189768088579
Probability=0.36238
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(19.047) ├┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 16856), ('10 0', 17534), ('11 0', 18929), ('00 1', 6591), ('10 1', 16323), ('00 0', 10155), ('11 1', 6301), ('01 1', 7311)]
Our simulation...
[-0.42479031  0.44739109  0.66849618  0.41533993]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7823432149084061
Probability=0.36526
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(17.772) ├┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 19109), ('10 0', 15993), ('11 0', 16816), ('00 1', 8901), ('10 1', 19235), ('00 0', 7439), ('11 1', 8205), ('01 1', 4302)]
Our simulation...
[-0.46797917  0.32534364  0.68794421  0.44931034]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7674865511717355
Probability=0.40643
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(16.581) ├┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 14610), ('10 0', 14197), ('11 0', 13689), ('00 1', 10466), ('10 1', 20992), ('00 0', 9993), ('11 1', 10195), ('01 1', 5858)]
Our simulation...
[-0.46934617  0.35113781  0.66470634  0.46322984]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7777127970017551
Probability=0.47511
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(15.471) ├┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 9687), ('10 0', 11308), ('11 0', 13450), ('00 1', 9240), ('10 1', 23269), ('00 0', 16080), ('11 1', 9496), ('01 1', 7470)]
Our simulation...
[-0.43215852  0.38856833  0.6857976   0.43810424]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7902164196420702
Probability=0.49474999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(14.435) ├┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 6902), ('10 0', 9699), ('11 0', 15961), ('00 1', 8524), ('10 1', 23022), ('00 0', 21266), ('11 1', 7635), ('01 1', 6991)]
Our simulation...
[-0.42966737  0.38911709  0.70612597  0.40664476]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7725738164321593
Probability=0.46172
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(13.468) ├┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 5695), ('10 0', 11022), ('11 0', 16766), ('00 1', 9774), ('10 1', 19516), ('00 0', 23049), ('11 1', 7982), ('01 1', 6196)]
Our simulation...
[-0.47418885  0.37754687  0.67005519  0.42851994]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7584460932549038
Probability=0.43468
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌────────┐┌──────────┐                        »
«    s_0: ┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├────────────────────────»
«         └────┬────┘└────┬────┘└───┬────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■──────────┼─────────┼──────────┼──────┤0     ├────────────────»
«                         │         │          │      │      │                »
«    j_1: ────────────────■─────────┼──────────┼──────┤1     ├────────────────»
«                                   │          │      │  qft │                »
«    j_2: ──────────────────────────■──────────┼──────┤2     ├────────────────»
«                                              │      │      │                »
«    j_3: ─────────────────────────────────────■──────┤3     ├───────■────────»
«                                                     └──────┘┌──────┴───────┐»
«    q_0: ────────────────────────────────────────────────────┤0             ├»
«                                                             │  gate_1/2_dg │»
«    q_1: ────────────────────────────────────────────────────┤1             ├»
«                                                             └──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('01 0', 5522), ('10 0', 14137), ('11 0', 14317), ('00 1', 10796), ('10 1', 14078), ('00 0', 22757), ('11 1', 12471), ('01 1', 5922)]
Our simulation...
[-0.49952019  0.36996089  0.57041651  0.53687385]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7855876310166781
Probability=0.43267
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 5945), ('10 0', 16774), ('11 0', 11547), ('00 1', 10200), ('10 1', 9725), ('00 0', 21938), ('11 1', 17486), ('01 1', 6385)]
Our simulation...
[-0.48259505  0.381824    0.4712242   0.6318704 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.805901740202648
Probability=0.43795999999999996
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 6792), ('10 0', 17610), ('11 0', 10417), ('00 1', 9381), ('10 1', 7491), ('00 0', 20198), ('11 1', 20253), ('01 1', 7858)]
Our simulation...
[-0.45666777  0.41795719  0.40808036  0.67099684]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.80990540206302
Probability=0.44982999999999995
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 7232), ('10 0', 16861), ('11 0', 11685), ('00 1', 9454), ('10 1', 6961), ('00 0', 16473), ('11 1', 20662), ('01 1', 10672)]
Our simulation...
[-0.4449648   0.47276005  0.38181561  0.6578154 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8013038734443937
Probability=0.47749
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 8494), ('10 0', 15884), ('11 0', 13637), ('00 1', 10452), ('10 1', 6914), ('00 0', 11999), ('11 1', 19390), ('01 1', 13230)]
Our simulation...
[-0.45727295  0.51446488  0.37191226  0.6228231 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7762971675689633
Probability=0.49985999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 11358), ('10 0', 15305), ('11 0', 15465), ('00 1', 10269), ('10 1', 6799), ('00 0', 8278), ('11 1', 17880), ('01 1', 14646)]
Our simulation...
[-0.45503993  0.54343167  0.37026098  0.60043941]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7659517024925786
Probability=0.49594000000000005
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 15354), ('10 0', 14646), ('11 0', 15847), ('00 1', 9304), ('10 1', 6648), ('00 0', 6327), ('11 1', 17834), ('01 1', 14040)]
Our simulation...
[-0.44106523  0.54181562  0.37283225  0.61064999]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7788907955623339
Probability=0.47826
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 20307), ('10 0', 14222), ('11 0', 14615), ('00 1', 7503), ('10 1', 6548), ('00 0', 5699), ('11 1', 18784), ('01 1', 12322)]
Our simulation...
[-0.40761948  0.5223698   0.38079549  0.6449581 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8141280438141668
Probability=0.45157
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 25029), ('10 0', 13488), ('11 0', 13091), ('00 1', 5644), ('10 1', 6786), ('00 0', 5762), ('11 1', 19996), ('01 1', 10204)]
Our simulation...
[-0.36386127  0.48924631  0.39897829  0.68487908]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8580966477549435
Probability=0.4263
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 28384), ('10 0', 12617), ('11 0', 12034), ('00 1', 4193), ('10 1', 7306), ('00 0', 5825), ('11 1', 21008), ('01 1', 8633)]
Our simulation...
[-0.31924955  0.4580878   0.42141277  0.71459539]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8957130910376437
Probability=0.4114
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌────────┐┌──────────┐┌──────────┐                        »
«    s_0: ┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├────────────────────────»
«         └────┬────┘└───┬────┘└────┬─────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■─────────┼──────────┼───────────┼──────┤0     ├────────────────»
«                        │          │           │      │      │                »
«    j_1: ───────────────■──────────┼───────────┼──────┤1     ├────────────────»
«                                   │           │      │  qft │                »
«    j_2: ──────────────────────────■───────────┼──────┤2     ├────────────────»
«                                               │      │      │                »
«    j_3: ──────────────────────────────────────■──────┤3     ├───────■────────»
«                                                      └──────┘┌──────┴───────┐»
«    q_0: ─────────────────────────────────────────────────────┤0             ├»
«                                                              │  gate_1/2_dg │»
«    q_1: ─────────────────────────────────────────────────────┤1             ├»
«                                                              └──────────────┘»
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('01 0', 30702), ('10 0', 12227), ('11 0', 11701), ('00 1', 3497), ('10 1', 7512), ('00 0', 6245), ('11 1', 20392), ('01 1', 7724)]
Our simulation...
[-0.2989652   0.44431805  0.43817805  0.72194271]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9125508067894189
Probability=0.39125
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 31657), ('10 0', 11508), ('11 0', 12311), ('00 1', 3538), ('10 1', 7970), ('00 0', 6256), ('11 1', 19478), ('01 1', 7282)]
Our simulation...
[-0.30406122  0.43622189  0.45636389  0.71343481]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9164783283213306
Probability=0.38268
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 32017), ('10 0', 11031), ('11 0', 13367), ('00 1', 3825), ('10 1', 8512), ('00 0', 6232), ('11 1', 17625), ('01 1', 7391)]
Our simulation...
[-0.32000221  0.44482466  0.47736774  0.68691313]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.9125803735427129
Probability=0.37353000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 31368), ('10 0', 10683), ('11 0', 14739), ('00 1', 4283), ('10 1', 8787), ('00 0', 6433), ('11 1', 15903), ('01 1', 7804)]
Our simulation...
[-0.34126039  0.46064937  0.48880109  0.65758421]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.899830949386831
Probability=0.36777000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 30251), ('10 0', 10258), ('11 0', 15649), ('00 1', 4750), ('10 1', 9329), ('00 0', 6821), ('11 1', 14468), ('01 1', 8474)]
Our simulation...
[-0.35819765  0.47843193  0.50198816  0.62514416]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8859691777583809
Probability=0.37021
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 28775), ('10 0', 10233), ('11 0', 15877), ('00 1', 5241), ('10 1', 9695), ('00 0', 7161), ('11 1', 13545), ('01 1', 9473)]
Our simulation...
[-0.37160222  0.49959144  0.50541151  0.59739382]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8695500051864917
Probability=0.37954
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 26907), ('10 0', 10054), ('11 0', 15856), ('00 1', 5866), ('10 1', 10075), ('00 0', 7805), ('11 1', 13184), ('01 1', 10253)]
Our simulation...
[-0.38596169  0.51026837  0.50581965  0.57862444]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8544031029948985
Probability=0.39378
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 25439), ('10 0', 10064), ('11 0', 15300), ('00 1', 6314), ('10 1', 10419), ('00 0', 8004), ('11 1', 13290), ('01 1', 11170)]
Our simulation...
[-0.39150794  0.52073273  0.50292278  0.5680032 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8452894635208269
Probability=0.41193
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23874), ('10 0', 9740), ('11 0', 14143), ('00 1', 6720), ('10 1', 10822), ('00 0', 8786), ('11 1', 13891), ('01 1', 12024)]
Our simulation...
[-0.39323735  0.52601074  0.49902683  0.56537537]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8414702521759049
Probability=0.43457
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 22269), ('10 0', 9930), ('11 0', 13537), ('00 1', 7038), ('10 1', 11236), ('00 0', 9351), ('11 1', 14238), ('01 1', 12401)]
Our simulation...
[-0.39585725  0.52546322  0.50017253  0.56303898]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8395825440110395
Probability=0.44913000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────┐┌──────────┐┌──────────┐┌──────────┐        »
«    s_0: ┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├────────»
«         └───┬────┘└────┬─────┘└────┬─────┘└────┬─────┘┌──────┐»
«    j_0: ────■──────────┼───────────┼───────────┼──────┤0     ├»
«                        │           │           │      │      │»
«    j_1: ───────────────■───────────┼───────────┼──────┤1     ├»
«                                    │           │      │  qft │»
«    j_2: ───────────────────────────■───────────┼──────┤2     ├»
«                                                │      │      │»
«    j_3: ───────────────────────────────────────■──────┤3     ├»
«                                                       └──────┘»
«    q_0: ──────────────────────────────────────────────────────»
«                                                               »
«    q_1: ──────────────────────────────────────────────────────»
«                                                               »
«   cr_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_1: ══════════════════════════════════════════════════════»
«                                                               »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 20882), ('10 0', 10176), ('11 0', 12659), ('00 1', 7082), ('10 1', 11318), ('00 0', 10014), ('11 1', 15007), ('01 1', 12862)]
Our simulation...
[-0.39123068  0.52724103  0.49458369  0.5695107 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8426138617591192
Probability=0.46269
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 19883), ('10 0', 10550), ('11 0', 12109), ('00 1', 7047), ('10 1', 11008), ('00 0', 11029), ('11 1', 15295), ('01 1', 13079)]
Our simulation...
[-0.3895897   0.53075318  0.48692217  0.57395795]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8422635984727291
Probability=0.46429
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 19084), ('10 0', 11194), ('11 0', 11446), ('00 1', 7218), ('10 1', 11093), ('00 0', 11578), ('11 1', 15415), ('01 1', 12972)]
Our simulation...
[-0.39315092  0.52705305  0.4873886   0.57454311]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8413080685185641
Probability=0.46698
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 18626), ('10 0', 11574), ('11 0', 11208), ('00 1', 6945), ('10 1', 10733), ('00 0', 12562), ('11 1', 15536), ('01 1', 12816)]
Our simulation...
[-0.38843257  0.52766193  0.48288096  0.58096386]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8446371656188119
Probability=0.4603
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 18315), ('10 0', 12324), ('11 0', 11432), ('00 1', 6960), ('10 1', 10237), ('00 0', 13342), ('11 1', 15082), ('01 1', 12308)]
Our simulation...
[-0.39509405  0.52539945  0.47916184  0.58160126]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8404755251642775
Probability=0.44587
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 18541), ('10 0', 13004), ('11 0', 11740), ('00 1', 6425), ('10 1', 9647), ('00 0', 14193), ('11 1', 14674), ('01 1', 11776)]
Our simulation...
[-0.38871359  0.52624994  0.47630956  0.58744528]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.844873442398971
Probability=0.42522000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 18307), ('10 0', 14004), ('11 0', 12163), ('00 1', 6213), ('10 1', 9177), ('00 0', 15068), ('11 1', 14027), ('01 1', 11041)]
Our simulation...
[-0.39187582  0.52239859  0.47626444  0.5888168 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8442291576396066
Probability=0.40458000000000005
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 18475), ('10 0', 14936), ('11 0', 12765), ('00 1', 5750), ('10 1', 8379), ('00 0', 15983), ('11 1', 13472), ('01 1', 10240)]
Our simulation...
[-0.38980968  0.520198    0.47055977  0.59667073]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8464110578179421
Probability=0.37840999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 19017), ('10 0', 15733), ('11 0', 13385), ('00 1', 5248), ('10 1', 7988), ('00 0', 16666), ('11 1', 12519), ('01 1', 9444)]
Our simulation...
[-0.3861284   0.5179798   0.47638038  0.59637531]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8505051005900175
Probability=0.35199
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 19238), ('10 0', 16560), ('11 0', 14418), ('00 1', 4991), ('10 1', 7173), ('00 0', 17409), ('11 1', 11539), ('01 1', 8672)]
Our simulation...
[-0.3926349   0.5175529   0.47070144  0.59700669]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.845436941335842
Probability=0.32375000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌──────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├────────»
«         └────┬─────┘└────┬─────┘└────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼───────────┼────────────┼──────┤0     ├»
«                          │           │            │      │      │»
«    j_1: ─────────────────■───────────┼────────────┼──────┤1     ├»
«                                      │            │      │  qft │»
«    j_2: ─────────────────────────────■────────────┼──────┤2     ├»
«                                                   │      │      │»
«    j_3: ──────────────────────────────────────────■──────┤3     ├»
«                                                          └──────┘»
«    q_0: ─────────────────────────────────────────────────────────»
«                                                                  »
«    q_1: ─────────────────────────────────────────────────────────»
«                                                                  »
«   cr_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_1: ═════════════════════════════════════════════════════════»
«                                                                  »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 19650), ('10 0', 17439), ('11 0', 14787), ('00 1', 4426), ('10 1', 6521), ('00 0', 18611), ('11 1', 10679), ('01 1', 7887)]
Our simulation...
[-0.38725678  0.51695084  0.47005689  0.60153183]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8496452579696474
Probability=0.29513
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 20362), ('10 0', 17823), ('11 0', 15784), ('00 1', 4097), ('10 1', 5958), ('00 0', 18977), ('11 1', 9721), ('01 1', 7278)]
Our simulation...
[-0.38915018  0.51866899  0.46928266  0.59943173]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8474573906859653
Probability=0.27054
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 20603), ('10 0', 18687), ('11 0', 16784), ('00 1', 3751), ('10 1', 5401), ('00 0', 19480), ('11 1', 8778), ('01 1', 6516)]
Our simulation...
[-0.39171448  0.51628158  0.47003823  0.59923046]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.846613597000071
Probability=0.24446
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 21002), ('10 0', 19275), ('11 0', 17440), ('00 1', 3290), ('10 1', 4776), ('00 0', 20344), ('11 1', 7903), ('01 1', 5970)]
Our simulation...
[-0.38724831  0.52164945  0.46657745  0.60018837]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8473615728121161
Probability=0.21939
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 21400), ('10 0', 20046), ('11 0', 18278), ('00 1', 3061), ('10 1', 4329), ('00 0', 20715), ('11 1', 7161), ('01 1', 5010)]
Our simulation...
[-0.39558165  0.50608485  0.47043353  0.60505006]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8478608696370059
Probability=0.19560999999999998
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 21572), ('10 0', 20934), ('11 0', 18993), ('00 1', 2678), ('10 1', 3853), ('00 0', 20987), ('11 1', 6389), ('01 1', 4594)]
Our simulation...
[-0.39103228  0.51215666  0.46903671  0.60398169]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8487299350639761
Probability=0.17514000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 21918), ('10 0', 21198), ('11 0', 19563), ('00 1', 2354), ('10 1', 3467), ('00 0', 21635), ('11 1', 5703), ('01 1', 4162)]
Our simulation...
[-0.38738886  0.51510401  0.47013309  0.60296983]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8503188933076797
Probability=0.15686
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 22341), ('10 0', 21448), ('11 0', 20353), ('00 1', 2062), ('10 1', 3004), ('00 0', 22059), ('11 1', 5086), ('01 1', 3647)]
Our simulation...
[-0.38656321  0.51409582  0.46658004  0.60710578]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8509992545854383
Probability=0.13799
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 22760), ('10 0', 21912), ('11 0', 20759), ('00 1', 1796), ('10 1', 2695), ('00 0', 22306), ('11 1', 4488), ('01 1', 3284)]
Our simulation...
[-0.38269677  0.51749149  0.46879289  0.60496195]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.852638482272909
Probability=0.12263000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 22928), ('10 0', 22251), ('11 0', 21157), ('00 1', 1647), ('10 1', 2336), ('00 0', 22754), ('11 1', 4053), ('01 1', 2874)]
Our simulation...
[-0.38853883  0.51325242  0.46272615  0.60950311]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8494834655669087
Probability=0.10909999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├────────»
«         └────┬─────┘└────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼────────────┼────────────┼──────┤0     ├»
«                          │            │            │      │      │»
«    j_1: ─────────────────■────────────┼────────────┼──────┤1     ├»
«                                       │            │      │  qft │»
«    j_2: ──────────────────────────────■────────────┼──────┤2     ├»
«                                                    │      │      │»
«    j_3: ───────────────────────────────────────────■──────┤3     ├»
«                                                           └──────┘»
«    q_0: ──────────────────────────────────────────────────────────»
«                                                                   »
«    q_1: ──────────────────────────────────────────────────────────»
«                                                                   »
«   cr_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_1: ══════════════════════════════════════════════════════════»
«                                                                   »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23282), ('10 0', 22785), ('11 0', 21779), ('00 1', 1450), ('10 1', 1974), ('00 0', 22758), ('11 1', 3496), ('01 1', 2476)]
Our simulation...
[-0.3928371   0.51333848  0.4583551   0.60997805]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8457879523042017
Probability=0.09396
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23435), ('10 0', 22943), ('11 0', 21978), ('00 1', 1256), ('10 1', 1805), ('00 0', 23266), ('11 1', 3141), ('01 1', 2176)]
Our simulation...
[-0.38719045  0.50963502  0.46416076  0.61229934]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8520307533279199
Probability=0.08378
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23595), ('10 0', 22949), ('11 0', 22558), ('00 1', 1115), ('10 1', 1593), ('00 0', 23435), ('11 1', 2813), ('01 1', 1942)]
Our simulation...
[-0.38652778  0.51011476  0.46200978  0.61394313]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8520711991209369
Probability=0.07463
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23817), ('10 0', 23448), ('11 0', 22527), ('00 1', 997), ('10 1', 1378), ('00 0', 23680), ('11 1', 2430), ('01 1', 1723)]
Our simulation...
[-0.39080266  0.51375086  0.45944606  0.61011691]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8472507549614103
Probability=0.06527999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23866), ('10 0', 23513), ('11 0', 23067), ('00 1', 888), ('10 1', 1282), ('00 0', 23866), ('11 1', 2046), ('01 1', 1472)]
Our simulation...
[-0.39511789  0.50871449  0.47474918  0.59975382]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8475178038715497
Probability=0.05688
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 23906), ('10 0', 23706), ('11 0', 23137), ('00 1', 743), ('10 1', 1097), ('00 0', 24287), ('11 1', 1785), ('01 1', 1339)]
Our simulation...
[-0.386882    0.51936706  0.47009694  0.59965744]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8489067987812648
Probability=0.049640000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24237), ('10 0', 23835), ('11 0', 23632), ('00 1', 685), ('10 1', 919), ('00 0', 24023), ('11 1', 1559), ('01 1', 1110)]
Our simulation...
[-0.40038596  0.50967701  0.46375789  0.60402736]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8421997249064749
Probability=0.04273
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24188), ('10 0', 23978), ('11 0', 23806), ('00 1', 594), ('10 1', 818), ('00 0', 24196), ('11 1', 1414), ('01 1', 1006)]
Our simulation...
[-0.39371365  0.512373    0.46202333  0.60745198]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8459505394600405
Probability=0.03832
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24514), ('10 0', 23927), ('11 0', 23837), ('00 1', 516), ('10 1', 746), ('00 0', 24420), ('11 1', 1190), ('01 1', 850)]
Our simulation...
[-0.39530865  0.5073655   0.4753143   0.60032295]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8479535079123356
Probability=0.03302
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24574), ('10 0', 24184), ('11 0', 23886), ('00 1', 451), ('10 1', 634), ('00 0', 24433), ('11 1', 1100), ('01 1', 738)]
Our simulation...
[-0.39280216  0.50247421  0.46572572  0.6134539 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8508007147095208
Probability=0.029230000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌───────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├────────»
«         └────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■────────────┼────────────┼────────────┼──────┤0     ├»
«                           │            │            │      │      │»
«    j_1: ──────────────────■────────────┼────────────┼──────┤1     ├»
«                                        │            │      │  qft │»
«    j_2: ───────────────────────────────■────────────┼──────┤2     ├»
«                                                     │      │      │»
«    j_3: ────────────────────────────────────────────■──────┤3     ├»
«                                                            └──────┘»
«    q_0: ───────────────────────────────────────────────────────────»
«                                                                    »
«    q_1: ───────────────────────────────────────────────────────────»
«                                                                    »
«   cr_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_1: ═══════════════════════════════════════════════════════════»
«                                                                    »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24299), ('10 0', 24435), ('11 0', 24397), ('00 1', 395), ('10 1', 525), ('00 0', 24328), ('11 1', 933), ('01 1', 688)]
Our simulation...
[-0.39427225  0.5203456   0.45454545  0.60595237]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8414289444616608
Probability=0.02541
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24654), ('10 0', 24447), ('11 0', 24196), ('00 1', 344), ('10 1', 464), ('00 0', 24495), ('11 1', 845), ('01 1', 555)]
Our simulation...
[-0.39471142  0.50135685  0.45841567  0.61862693]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8488935439875887
Probability=0.02208
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24544), ('10 0', 24412), ('11 0', 24325), ('00 1', 302), ('10 1', 420), ('00 0', 24721), ('11 1', 762), ('01 1', 514)]
Our simulation...
[-0.38878162  0.50720534  0.45848687  0.61756083]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.851086886921069
Probability=0.019979999999999998
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24742), ('10 0', 24598), ('11 0', 24478), ('00 1', 260), ('10 1', 345), ('00 0', 24510), ('11 1', 618), ('01 1', 449)]
Our simulation...
[-0.39433792  0.5182091   0.45424631  0.60796153]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8422189862143592
Probability=0.01672
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24701), ('10 0', 24749), ('11 0', 24515), ('00 1', 238), ('10 1', 304), ('00 0', 24537), ('11 1', 524), ('01 1', 432)]
Our simulation...
[-0.39859567  0.53701444  0.45048557  0.5914387 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8302897196330794
Probability=0.01498
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24725), ('10 0', 24789), ('11 0', 24528), ('00 1', 198), ('10 1', 266), ('00 0', 24715), ('11 1', 462), ('01 1', 317)]
Our simulation...
[-0.39911406  0.50500313  0.4625996   0.6096568 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8448348689292227
Probability=0.01243
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24927), ('10 0', 24595), ('11 0', 24682), ('00 1', 170), ('10 1', 238), ('00 0', 24710), ('11 1', 408), ('01 1', 270)]
Our simulation...
[-0.39564852  0.49861687  0.46813764  0.61293606]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8503649824926618
Probability=0.010860000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24900), ('10 0', 24816), ('11 0', 24600), ('00 1', 156), ('10 1', 219), ('00 0', 24720), ('11 1', 338), ('01 1', 251)]
Our simulation...
[-0.40227568  0.51026801  0.47663238  0.59213377]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8415060250996794
Probability=0.00964
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24831), ('10 0', 24806), ('11 0', 24666), ('00 1', 146), ('10 1', 166), ('00 0', 24879), ('11 1', 295), ('01 1', 211)]
Our simulation...
[-0.4224738   0.50788405  0.45048195  0.60052951]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8241837835352185
Probability=0.00818
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24941), ('10 0', 24768), ('11 0', 24786), ('00 1', 119), ('10 1', 163), ('00 0', 24764), ('11 1', 252), ('01 1', 207)]
Our simulation...
[-0.40074155  0.52853782  0.4690128   0.58316462]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8341532708226493
Probability=0.00741
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌───────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼────────────┼───────┤0     ├»
«                            │            │            │       │      │»
«    j_1: ───────────────────■────────────┼────────────┼───────┤1     ├»
«                                         │            │       │  qft │»
«    j_2: ────────────────────────────────■────────────┼───────┤2     ├»
«                                                      │       │      │»
«    j_3: ─────────────────────────────────────────────■───────┤3     ├»
«                                                              └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────»
«                                                                      »
«    q_1: ─────────────────────────────────────────────────────────────»
«                                                                      »
«   cr_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_1: ═════════════════════════════════════════════════════════════»
«                                                                      »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24831), ('10 0', 24500), ('11 0', 24927), ('00 1', 113), ('10 1', 135), ('00 0', 25065), ('11 1', 262), ('01 1', 167)]
Our simulation...
[-0.40854969  0.49666539  0.44655253  0.62209443]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8384905068605429
Probability=0.00677
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24792), ('10 0', 24712), ('11 0', 24946), ('00 1', 66), ('10 1', 122), ('00 0', 25039), ('11 1', 181), ('01 1', 142)]
Our simulation...
[-0.3593863   0.52714941  0.488618    0.59515329]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.866198743252285
Probability=0.00511
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24690), ('10 0', 24734), ('11 0', 24803), ('00 1', 80), ('10 1', 99), ('00 0', 25294), ('11 1', 177), ('01 1', 123)]
Our simulation...
[-0.40867421  0.50673955  0.45462136  0.60788143]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8359728175142253
Probability=0.00479
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24941), ('10 0', 24848), ('11 0', 24822), ('00 1', 48), ('10 1', 86), ('00 0', 24987), ('11 1', 161), ('01 1', 107)]
Our simulation...
[-0.34554737  0.51591584  0.46252605  0.63284873]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8773950734834106
Probability=0.00402
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24756), ('10 0', 24642), ('11 0', 25266), ('00 1', 46), ('10 1', 77), ('00 0', 24973), ('11 1', 123), ('01 1', 117)]
Our simulation...
[-0.35598     0.56772709  0.46056619  0.5821022 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8463665247590573
Probability=0.00363
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 25030), ('10 0', 24582), ('11 0', 24993), ('00 1', 65), ('10 1', 85), ('00 0', 25045), ('11 1', 111), ('01 1', 89)]
Our simulation...
[-0.4309458   0.5042675   0.49280538  0.56315438]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8205284360389427
Probability=0.0035000000000000005
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24974), ('10 0', 25026), ('11 0', 25010), ('00 1', 53), ('10 1', 48), ('00 0', 24714), ('11 1', 94), ('01 1', 81)]
Our simulation...
[-0.43821112  0.54173634  0.41702883  0.58359208]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7914813803927144
Probability=0.00276
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24813), ('10 0', 24868), ('11 0', 25026), ('00 1', 45), ('10 1', 47), ('00 0', 25038), ('11 1', 90), ('01 1', 73)]
Our simulation...
[-0.42008403  0.53504627  0.42931774  0.59408853]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8115503312320864
Probability=0.00255
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24953), ('10 0', 25174), ('11 0', 24678), ('00 1', 34), ('10 1', 41), ('00 0', 24973), ('11 1', 84), ('01 1', 63)]
Our simulation...
[-0.39134787  0.5327136   0.42974956  0.61512469]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8344923013734149
Probability=0.00222
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24957), ('10 0', 24608), ('11 0', 25050), ('00 1', 22), ('10 1', 39), ('00 0', 25212), ('11 1', 63), ('01 1', 49)]
Our simulation...
[-0.35660571  0.53220014  0.47479841  0.60345824]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8650405856073673
Probability=0.00173
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼─────────────┼───────┤0     ├»
«                            │            │             │       │      │»
«    j_1: ───────────────────■────────────┼─────────────┼───────┤1     ├»
«                                         │             │       │  qft │»
«    j_2: ────────────────────────────────■─────────────┼───────┤2     ├»
«                                                       │       │      │»
«    j_3: ──────────────────────────────────────────────■───────┤3     ├»
«                                                               └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24848), ('10 0', 25000), ('11 0', 25137), ('00 1', 23), ('10 1', 39), ('00 0', 24846), ('11 1', 65), ('01 1', 42)]
Our simulation...
[-0.36891012  0.49851852  0.48038446  0.62017367]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8706262897448015
Probability=0.0016899999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├┤ RY(0.01145) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 24957), ('10 0', 25128), ('11 0', 24877), ('00 1', 21), ('10 1', 27), ('00 0', 24904), ('11 1', 46), ('01 1', 40)]
Our simulation...
[-0.39587425  0.54635836  0.4488792   0.58590407]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8276298480058706
Probability=0.00134
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├┤ RY(0.010683) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼───────────────┼────────»
«                                │               │               │        »
«    j_1: ───────────────────────■───────────────┼───────────────┼────────»
«                                                │               │        »
«    j_2: ───────────────────────────────────────■───────────────┼────────»
«                                                                │        »
«    j_3: ───────────────────────────────────────────────────────■────────»
«                                                                         »
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 25025), ('10 0', 24862), ('11 0', 25132), ('00 1', 23), ('10 1', 28), ('00 0', 24858), ('11 1', 47), ('01 1', 25)]
Our simulation...
[-0.43242557  0.45083482  0.47711872  0.61815356]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8373049088380792
Probability=0.00123
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├┤ RY(0.0099678) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24978), ('10 0', 24970), ('11 0', 24852), ('00 1', 21), ('10 1', 31), ('00 0', 25067), ('11 1', 51), ('01 1', 30)]
Our simulation...
[-0.39735971  0.47493569  0.4827864   0.61924038]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8582885928831562
Probability=0.00133
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├┤ RY(0.0093003) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 25158), ('10 0', 24959), ('11 0', 25073), ('00 1', 13), ('10 1', 16), ('00 0', 24715), ('11 1', 40), ('01 1', 26)]
Our simulation...
[-0.36992176  0.52314836  0.41039134  0.64888568]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8481788714936236
Probability=0.0009500000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├┤ RY(0.0086775) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼────────────────┼────────»
«                               │              │                │        »
«    j_1: ──────────────────────■──────────────┼────────────────┼────────»
«                                              │                │        »
«    j_2: ─────────────────────────────────────■────────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 25069), ('10 0', 24842), ('11 0', 25094), ('00 1', 8), ('10 1', 12), ('00 0', 24922), ('11 1', 25), ('01 1', 28)]
Our simulation...
[-0.33104236  0.61932354  0.40544243  0.58520574]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8235931813504679
Probability=0.00073
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├┤ RY(0.0080964) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 25117), ('10 0', 24988), ('11 0', 24957), ('00 1', 12), ('10 1', 9), ('00 0', 24879), ('11 1', 25), ('01 1', 13)]
Our simulation...
[-0.45098762  0.46940279  0.39056673  0.65094455]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8002811670218719
Probability=0.00059
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├┤ RY(0.0075542) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 25094), ('10 0', 24773), ('11 0', 24879), ('00 1', 13), ('10 1', 11), ('00 0', 25200), ('11 1', 17), ('01 1', 13)]
Our simulation...
[-0.49065338  0.49065338  0.45133547  0.56108361]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7703587891582143
Probability=0.00054
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├┤ RY(0.0070483) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 24992), ('10 0', 24920), ('11 0', 25179), ('00 1', 10), ('10 1', 7), ('00 0', 24864), ('11 1', 15), ('01 1', 13)]
Our simulation...
[-0.47140452  0.53748385  0.39440532  0.57735027]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7602816607271684
Probability=0.00045
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├┤ RY(0.0065763) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('01 0', 25156), ('10 0', 25017), ('11 0', 24823), ('00 1', 9), ('10 1', 12), ('00 0', 24944), ('11 1', 24), ('01 1', 15)]
Our simulation...
[-0.38729833  0.5         0.4472136   0.63245553]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8528593808427507
Probability=0.0006
--------------------------------------------------
--------------------------------------------------
Simulating with r=10.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├┤ RY(pi/512) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('01 0', 25020), ('10 0', 24859), ('11 0', 24812), ('00 1', 5), ('10 1', 4), ('00 0', 25275), ('11 1', 16), ('01 1', 9)]
Our simulation...
[-0.38348249  0.51449576  0.34299717  0.68599434]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8178938508412594
Probability=0.00034
--------------------------------------------------
**************************************************
Max fidelity is 0.9164783283213306, when r=3.1
Min fidelity is 0.5956364356120037, when r=1.1
