--------------------------------------------------
Simulating with r=1.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌─────────┐┌────────┐                        »
«    s_0: ┤ RY(8pi) ├┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├────────────────────────»
«         └────┬────┘└────┬────┘└────┬────┘└───┬────┘┌──────┐                »
«    j_0: ─────■──────────┼──────────┼─────────┼─────┤0     ├────────────────»
«                         │          │         │     │      │                »
«    j_1: ────────────────■──────────┼─────────┼─────┤1     ├────────────────»
«                                    │         │     │  qft │                »
«    j_2: ───────────────────────────■─────────┼─────┤2     ├────────────────»
«                                              │     │      │                »
«    j_3: ─────────────────────────────────────■─────┤3     ├───────■────────»
«                                                    └──────┘┌──────┴───────┐»
«    q_0: ───────────────────────────────────────────────────┤0             ├»
«                                                            │  gate_1/2_dg │»
«    q_1: ───────────────────────────────────────────────────┤1             ├»
«                                                            └──────────────┘»
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('11 1', 8351), ('01 0', 12969), ('10 0', 14004), ('10 1', 3107), ('00 0', 32268), ('00 1', 6026), ('11 0', 14933), ('01 1', 8342)]
Our simulation...
[-0.48304322  0.56833777  0.34685028  0.56864427]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7221230326236353
Probability=0.25826
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(23.45) ├┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 8017), ('01 0', 14596), ('10 0', 14480), ('10 1', 4451), ('00 0', 14869), ('00 1', 12893), ('11 0', 18892), ('01 1', 11802)]
Our simulation...
[-0.58900856  0.56353698  0.34607754  0.4644624 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6080736615398716
Probability=0.37163
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(21.879) ├┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├────────»
«         └─────┬──────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼────────────┼─────────────┼───────┤0     ├»
«                             │            │             │       │      │»
«    j_1: ────────────────────■────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 13603), ('01 0', 9863), ('10 0', 10025), ('10 1', 10856), ('00 0', 10944), ('00 1', 12867), ('11 0', 12666), ('01 1', 19176)]
Our simulation...
[-0.47720693  0.58256864  0.43833183  0.49066541]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7301041017915496
Probability=0.5650200000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(20.414) ├┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 7153), ('01 0', 19511), ('10 0', 12501), ('10 1', 9580), ('00 0', 11459), ('00 1', 12639), ('11 0', 17460), ('01 1', 9697)]
Our simulation...
[-0.56877462  0.49819865  0.495184    0.42788589]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6675749747286179
Probability=0.39069
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(19.047) ├┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9046), ('01 0', 17747), ('10 0', 16528), ('10 1', 8198), ('00 0', 10345), ('00 1', 12700), ('11 0', 15963), ('01 1', 9473)]
Our simulation...
[-0.56762312  0.49023237  0.4560497   0.47905625]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6834268653510035
Probability=0.39416999999999996
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(17.772) ├┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 14763), ('01 0', 11471), ('10 0', 18128), ('10 1', 11264), ('00 0', 11643), ('00 1', 8667), ('11 0', 12636), ('01 1', 11428)]
Our simulation...
[-0.43349125  0.49777267  0.49418807  0.56576131]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.821135863820037
Probability=0.46122
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(16.581) ├┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 17033), ('01 0', 8649), ('10 0', 15944), ('10 1', 18522), ('00 0', 10039), ('00 1', 8325), ('11 0', 12594), ('01 1', 8894)]
Our simulation...
[-0.39717519  0.410524    0.59242576  0.5681141 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.867389021203474
Probability=0.52774
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(15.471) ├┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 20221), ('01 0', 4662), ('10 0', 15359), ('10 1', 22026), ('00 0', 7884), ('00 1', 11418), ('11 0', 9563), ('01 1', 8867)]
Our simulation...
[-0.42731079  0.37656261  0.59349444  0.56865669]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8484232268427478
Probability=0.6253200000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(14.435) ├┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 17011), ('01 0', 2499), ('10 0', 21580), ('10 1', 15304), ('00 0', 13248), ('00 1', 9388), ('11 0', 11466), ('01 1', 9504)]
Our simulation...
[-0.42817556  0.43081275  0.54668582  0.57636852]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8450272620568928
Probability=0.51207
--------------------------------------------------
--------------------------------------------------
Simulating with r=1.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(13.468) ├┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 8338), ('01 0', 3074), ('10 0', 26204), ('10 1', 8421), ('00 0', 19521), ('00 1', 6912), ('11 0', 17949), ('01 1', 9581)]
Our simulation...
[-0.45592455  0.53678026  0.50323744  0.50075127]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7774924442706111
Probability=0.33252
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌─────────┐┌────────┐┌──────────┐                        »
«    s_0: ┤ RY(4pi) ├┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├────────────────────────»
«         └────┬────┘└────┬────┘└───┬────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■──────────┼─────────┼──────────┼──────┤0     ├────────────────»
«                         │         │          │      │      │                »
«    j_1: ────────────────■─────────┼──────────┼──────┤1     ├────────────────»
«                                   │          │      │  qft │                »
«    j_2: ──────────────────────────■──────────┼──────┤2     ├────────────────»
«                                              │      │      │                »
«    j_3: ─────────────────────────────────────■──────┤3     ├───────■────────»
«                                                     └──────┘┌──────┴───────┐»
«    q_0: ────────────────────────────────────────────────────┤0             ├»
«                                                             │  gate_1/2_dg │»
«    q_1: ────────────────────────────────────────────────────┤1             ├»
«                                                             └──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('11 1', 3481), ('01 0', 4821), ('10 0', 22653), ('10 1', 8443), ('00 0', 19139), ('00 1', 9606), ('11 0', 21400), ('01 1', 10457)]
Our simulation...
[-0.54800502  0.57176399  0.5137616   0.32988704]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6175520434345555
Probability=0.31987
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(11.725) ├┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 3419), ('01 0', 7763), ('10 0', 16606), ('10 1', 12214), ('00 0', 14790), ('00 1', 14539), ('11 0', 21116), ('01 1', 9553)]
Our simulation...
[-0.60497206  0.49038586  0.5544942   0.29337128]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.5724370928064154
Probability=0.39725
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.94) ├┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 6082), ('01 0', 11654), ('10 0', 12789), ('10 1', 15784), ('00 0', 11029), ('00 1', 16268), ('11 0', 19810), ('01 1', 6584)]
Our simulation...
[-0.60315078  0.38371054  0.59411067  0.36879245]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6285433669940574
Probability=0.44718
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(10.207) ├┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 11440), ('01 0', 12964), ('10 0', 10992), ('10 1', 18629), ('00 0', 8746), ('00 1', 15509), ('11 0', 17113), ('01 1', 4607)]
Our simulation...
[-0.55591057  0.30298571  0.60926721  0.47744797]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7144414672560594
Probability=0.50185
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(9.5235) ├┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 17055), ('01 0', 11549), ('10 0', 10401), ('10 1', 21312), ('00 0', 7587), ('00 1', 13156), ('11 0', 13871), ('01 1', 5069)]
Our simulation...
[-0.48215249  0.29928409  0.61366956  0.54896966]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7972558166142864
Probability=0.5659200000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.8858) ├┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 20407), ('01 0', 8946), ('10 0', 11339), ('10 1', 22276), ('00 0', 7472), ('00 1', 11102), ('11 0', 12491), ('01 1', 5967)]
Our simulation...
[-0.43104676  0.31601071  0.61057973  0.58440424]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8456808857001153
Probability=0.59752
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(8.2907) ├┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 19752), ('01 0', 8107), ('10 0', 14398), ('10 1', 20601), ('00 0', 7864), ('00 1', 8719), ('11 0', 14226), ('01 1', 6333)]
Our simulation...
[-0.39669695  0.3380884   0.60977508  0.59707799]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8734450155928847
Probability=0.5540499999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.7355) ├┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 16713), ('01 0', 8756), ('10 0', 18491), ('10 1', 16867), ('00 0', 9321), ('00 1', 6600), ('11 0', 17692), ('01 1', 5560)]
Our simulation...
[-0.37986028  0.34864972  0.60725464  0.60447609]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8862176426062134
Probability=0.4574
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(7.2175) ├┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 13410), ('01 0', 10401), ('10 0', 21403), ('10 1', 13372), ('00 0', 10872), ('00 1', 5370), ('11 0', 20211), ('01 1', 4961)]
Our simulation...
[-0.38038564  0.36561296  0.60025412  0.60110641]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.886060050470428
Probability=0.37113
--------------------------------------------------
--------------------------------------------------
Simulating with r=2.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(6.7342) ├┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 11542), ('01 0', 11231), ('10 0', 22722), ('10 1', 10957), ('00 0', 11996), ('00 1', 5270), ('11 0', 20522), ('01 1', 5760)]
Our simulation...
[-0.39645601  0.41447748  0.57165701  0.58671911]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8714712968399249
Probability=0.33529
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────┐┌────────┐┌──────────┐┌──────────┐                        »
«    s_0: ┤ RY(2pi) ├┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├────────────────────────»
«         └────┬────┘└───┬────┘└────┬─────┘└────┬─────┘┌──────┐                »
«    j_0: ─────■─────────┼──────────┼───────────┼──────┤0     ├────────────────»
«                        │          │           │      │      │                »
«    j_1: ───────────────■──────────┼───────────┼──────┤1     ├────────────────»
«                                   │           │      │  qft │                »
«    j_2: ──────────────────────────■───────────┼──────┤2     ├────────────────»
«                                               │      │      │                »
«    j_3: ──────────────────────────────────────■──────┤3     ├───────■────────»
«                                                      └──────┘┌──────┴───────┐»
«    q_0: ─────────────────────────────────────────────────────┤0             ├»
«                                                              │  gate_1/2_dg │»
«    q_1: ─────────────────────────────────────────────────────┤1             ├»
«                                                              └──────────────┘»
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                           ░      ┌─┐ ░       
«    s_0: ──────────────────────────────────────────────────░──────┤M├─░───────
«                                                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────────────────────────────────────■─────────░─┤ H ├─╫──░───────
«                                                 │         ░ ├───┤ ║  ░       
«    j_1: ───────────────────────■────────────────┼─────────░─┤ H ├─╫──░───────
«                                │                │         ░ ├───┤ ║  ░       
«    j_2: ───────■───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«                │               │                │         ░ ├───┤ ║  ░       
«    j_3: ───────┼───────────────┼────────────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0             ├┤0             ├┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1             ├┤1             ├┤1              ├─░───────╫──░──╫─┤M├
«         └──────────────┘└──────────────┘└───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════════════════════════════════════╩═════╬══╬═
«                                                                         ║  ║ 
«crtmp_0: ════════════════════════════════════════════════════════════════╩══╬═
«                                                                            ║ 
«crtmp_1: ═══════════════════════════════════════════════════════════════════╩═
«                                                                              
[('11 1', 11153), ('01 0', 11743), ('10 0', 21595), ('10 1', 10318), ('00 0', 12983), ('00 1', 5694), ('11 0', 18476), ('01 1', 8038)]
Our simulation...
[-0.40217854  0.47784183  0.54138713  0.56286729]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8519615828566733
Probability=0.35203
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(5.8624) ├┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 11988), ('01 0', 10980), ('10 0', 19744), ('10 1', 10108), ('00 0', 14136), ('00 1', 6217), ('11 0', 15754), ('01 1', 11073)]
Our simulation...
[-0.39730085  0.53022684  0.50659591  0.55169929]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8354165540010569
Probability=0.39386
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.4698) ├┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 12785), ('01 0', 10631), ('10 0', 17469), ('10 1', 10203), ('00 0', 15021), ('00 1', 6842), ('11 0', 12960), ('01 1', 14089)]
Our simulation...
[-0.39469835  0.56638776  0.48198966  0.53954062]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.8178427366339315
Probability=0.43918999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(5.1035) ├┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 12765), ('01 0', 10741), ('10 0', 15621), ('10 1', 10441), ('00 0', 15780), ('00 1', 7393), ('11 0', 10656), ('01 1', 16603)]
Our simulation...
[-0.39575841  0.59307973  0.47031718  0.52003217]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7989139318931829
Probability=0.47202
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.7618) ├┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 12170), ('01 0', 11289), ('10 0', 14460), ('10 1', 9939), ('00 0', 16361), ('00 1', 8075), ('11 0', 9808), ('01 1', 17898)]
Our simulation...
[-0.4098076   0.610114    0.45465302  0.50309966]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7739883075905284
Probability=0.48082
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.4429) ├┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 11270), ('01 0', 12452), ('10 0', 13099), ('10 1', 9666), ('00 0', 17170), ('00 1', 8651), ('11 0', 9253), ('01 1', 18439)]
Our simulation...
[-0.42441913  0.6196272   0.44862677  0.48442188]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7523943062580024
Probability=0.48025999999999996
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(4.1454) ├┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 10452), ('01 0', 14084), ('10 0', 12383), ('10 1', 9146), ('00 0', 16543), ('00 1', 9674), ('11 0', 9417), ('01 1', 18301)]
Our simulation...
[-0.45094417  0.62023624  0.4384654   0.46872642]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7258168529404372
Probability=0.47573
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.8678) ├┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9552), ('01 0', 15797), ('10 0', 11995), ('10 1', 9228), ('00 0', 15935), ('00 1', 10963), ('11 0', 9436), ('01 1', 17094)]
Our simulation...
[-0.4838048   0.6041257   0.44387354  0.45159864]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7035279576529607
Probability=0.46836999999999995
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.6087) ├┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 8855), ('01 0', 17258), ('10 0', 11220), ('10 1', 9296), ('00 0', 14991), ('00 1', 12446), ('11 0', 9661), ('01 1', 16273)]
Our simulation...
[-0.51530864  0.58923201  0.4453491   0.43465713]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6785744297005921
Probability=0.4687
--------------------------------------------------
--------------------------------------------------
Simulating with r=3.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(3.3671) ├┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 8836), ('01 0', 18846), ('10 0', 10487), ('10 1', 9868), ('00 0', 13816), ('00 1', 13619), ('11 0', 9739), ('01 1', 14789)]
Our simulation...
[-0.5376589   0.56027808  0.45766616  0.43307397]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6727417512285704
Probability=0.47112
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────┐┌──────────┐┌──────────┐┌──────────┐        »
«    s_0: ┤ RY(pi) ├┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├────────»
«         └───┬────┘└────┬─────┘└────┬─────┘└────┬─────┘┌──────┐»
«    j_0: ────■──────────┼───────────┼───────────┼──────┤0     ├»
«                        │           │           │      │      │»
«    j_1: ───────────────■───────────┼───────────┼──────┤1     ├»
«                                    │           │      │  qft │»
«    j_2: ───────────────────────────■───────────┼──────┤2     ├»
«                                                │      │      │»
«    j_3: ───────────────────────────────────────■──────┤3     ├»
«                                                       └──────┘»
«    q_0: ──────────────────────────────────────────────────────»
«                                                               »
«    q_1: ──────────────────────────────────────────────────────»
«                                                               »
«   cr_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_0: ══════════════════════════════════════════════════════»
«                                                               »
«crtmp_1: ══════════════════════════════════════════════════════»
«                                                               »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9021), ('01 0', 19958), ('10 0', 9982), ('10 1', 10284), ('00 0', 12328), ('00 1', 15140), ('11 0', 9614), ('01 1', 13673)]
Our simulation...
[-0.56093063  0.53306249  0.46230357  0.4329857 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6623402583248829
Probability=0.48118000000000005
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(2.9312) ├┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9364), ('01 0', 20505), ('10 0', 9686), ('10 1', 10933), ('00 0', 11324), ('00 1', 16090), ('11 0', 9526), ('01 1', 12572)]
Our simulation...
[-0.57327335  0.50674085  0.47255613  0.4373352 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6621119018219662
Probability=0.48958999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.7349) ├┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9676), ('01 0', 21387), ('10 0', 9291), ('10 1', 11062), ('00 0', 10389), ('00 1', 17230), ('11 0', 9505), ('01 1', 11460)]
Our simulation...
[-0.59041328  0.48151053  0.47307534  0.44244716]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6544288653353957
Probability=0.49428
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.5518) ├┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9966), ('01 0', 22263), ('10 0', 9079), ('10 1', 11440), ('00 0', 9969), ('00 1', 17567), ('11 0', 9331), ('01 1', 10385)]
Our simulation...
[-0.59658183  0.45869549  0.4814312   0.44934681]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6568944715432596
Probability=0.49358
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.3809) ├┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 10351), ('01 0', 22556), ('10 0', 9113), ('10 1', 11407), ('00 0', 9654), ('00 1', 17628), ('11 0', 9741), ('01 1', 9550)]
Our simulation...
[-0.60018797  0.44176108  0.4828047   0.45991431]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6601997392258886
Probability=0.48936
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.2214) ├┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 10434), ('01 0', 22590), ('10 0', 9454), ('10 1', 11637), ('00 0', 9658), ('00 1', 17534), ('11 0', 10023), ('01 1', 8670)]
Our simulation...
[-0.6026697   0.42378776  0.490975    0.46490506]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6629718544520625
Probability=0.48275
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(2.0727) ├┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├────────»
«         └─────┬──────┘└─────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼──────────────┼──────────────┼───────┤0     ├»
«                             │              │              │       │      │»
«    j_1: ────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                            │              │       │  qft │»
«    j_2: ───────────────────────────────────■──────────────┼───────┤2     ├»
«                                                           │       │      │»
«    j_3: ──────────────────────────────────────────────────■───────┤3     ├»
«                                                                   └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«    q_1: ──────────────────────────────────────────────────────────────────»
«                                                                           »
«   cr_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_0: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«crtmp_1: ══════════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 10241), ('01 0', 23065), ('10 0', 10082), ('10 1', 11319), ('00 0', 9971), ('00 1', 17068), ('11 0', 10450), ('01 1', 7804)]
Our simulation...
[-0.60629309  0.40996798  0.49373661  0.4696372 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6628641554122857
Probability=0.46432
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.9339) ├┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 10083), ('01 0', 23228), ('10 0', 10763), ('10 1', 10962), ('00 0', 10503), ('00 1', 16390), ('11 0', 10904), ('01 1', 7167)]
Our simulation...
[-0.60619494  0.4008589   0.49575572  0.47546408]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6658787221084269
Probability=0.44601999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.8044) ├┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9796), ('01 0', 23065), ('10 0', 11455), ('10 1', 10523), ('00 0', 11235), ('00 1', 15660), ('11 0', 11766), ('01 1', 6500)]
Our simulation...
[-0.60716781  0.3911736   0.49771719  0.48021669]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6673430920885236
Probability=0.42479
--------------------------------------------------
--------------------------------------------------
Simulating with r=4.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.6835) ├┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 9279), ('01 0', 23321), ('10 0', 12481), ('10 1', 9798), ('00 0', 11969), ('00 1', 14465), ('11 0', 12717), ('01 1', 5970)]
Our simulation...
[-0.6050548   0.38870727  0.49797118  0.48460298]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6709310013922957
Probability=0.39512
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌──────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/2) ├┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├────────»
«         └────┬─────┘└────┬─────┘└────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼───────────┼────────────┼──────┤0     ├»
«                          │           │            │      │      │»
«    j_1: ─────────────────■───────────┼────────────┼──────┤1     ├»
«                                      │            │      │  qft │»
«    j_2: ─────────────────────────────■────────────┼──────┤2     ├»
«                                                   │      │      │»
«    j_3: ──────────────────────────────────────────■──────┤3     ├»
«                                                          └──────┘»
«    q_0: ─────────────────────────────────────────────────────────»
«                                                                  »
«    q_1: ─────────────────────────────────────────────────────────»
«                                                                  »
«   cr_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_0: ═════════════════════════════════════════════════════════»
«                                                                  »
«crtmp_1: ═════════════════════════════════════════════════════════»
«                                                                  »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 8622), ('01 0', 23759), ('10 0', 13418), ('10 1', 9410), ('00 0', 12810), ('00 1', 13294), ('11 0', 13348), ('01 1', 5339)]
Our simulation...
[-0.60214626  0.38159627  0.50660441  0.48492901]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.675070253907123
Probability=0.36665
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(1.4656) ├┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 8076), ('01 0', 23817), ('10 0', 14297), ('10 1', 8485), ('00 0', 13653), ('00 1', 12700), ('11 0', 14200), ('01 1', 4772)]
Our simulation...
[-0.61087414  0.3744554   0.49931637  0.48713355]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6668283104084726
Probability=0.34032999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.3675) ├┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 7403), ('01 0', 23715), ('10 0', 15357), ('10 1', 7782), ('00 0', 14841), ('00 1', 11273), ('11 0', 15342), ('01 1', 4287)]
Our simulation...
[-0.60552559  0.37341305  0.50310469  0.49070064]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6735232624949258
Probability=0.30745
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.2759) ├┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 7038), ('01 0', 23939), ('10 0', 16034), ('10 1', 7189), ('00 0', 15706), ('00 1', 10247), ('11 0', 16070), ('01 1', 3777)]
Our simulation...
[-0.60225644  0.36564242  0.50444907  0.49912316]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6794663115170668
Probability=0.28251000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1904) ├┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 6157), ('01 0', 24252), ('10 0', 17017), ('10 1', 6445), ('00 0', 16510), ('00 1', 9453), ('11 0', 16805), ('01 1', 3361)]
Our simulation...
[-0.60986151  0.36364754  0.50356769  0.49218795]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6700033301368404
Probability=0.25416
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.1107) ├┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 5839), ('01 0', 23975), ('10 0', 17875), ('10 1', 5857), ('00 0', 17251), ('00 1', 8368), ('11 0', 17735), ('01 1', 3100)]
Our simulation...
[-0.60104094  0.36582558  0.50284118  0.5020679 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6813148574838405
Probability=0.23163999999999998
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(1.0363) ├┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├────────»
«         └─────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                              │              │              │       │      │»
«    j_1: ─────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                             │              │       │  qft │»
«    j_2: ────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                            │       │      │»
«    j_3: ───────────────────────────────────────────────────■───────┤3     ├»
«                                                                    └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«    q_1: ───────────────────────────────────────────────────────────────────»
«                                                                            »
«   cr_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_0: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«crtmp_1: ═══════════════════════════════════════════════════════════════════»
«                                                                            »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 5075), ('01 0', 24225), ('10 0', 18481), ('10 1', 5447), ('00 0', 18090), ('00 1', 7566), ('11 0', 18471), ('01 1', 2645)]
Our simulation...
[-0.60409062  0.35717558  0.51256343  0.49475131]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6772320779435002
Probability=0.20733000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.96694) ├┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 4583), ('01 0', 24085), ('10 0', 19236), ('10 1', 4656), ('00 0', 19015), ('00 1', 6709), ('11 0', 19369), ('01 1', 2347)]
Our simulation...
[-0.60556768  0.35817093  0.50447573  0.50050535]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6767218175040054
Probability=0.18295
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.90219) ├┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 4227), ('01 0', 24370), ('10 0', 19923), ('10 1', 4083), ('00 0', 19549), ('00 1', 6002), ('11 0', 19719), ('01 1', 2127)]
Our simulation...
[-0.60424115  0.35970465  0.49837012  0.50708227]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6791999208680396
Probability=0.16439
--------------------------------------------------
--------------------------------------------------
Simulating with r=5.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.84177) ├┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 3708), ('01 0', 24577), ('10 0', 19881), ('10 1', 3733), ('00 0', 20497), ('00 1', 5294), ('11 0', 20522), ('01 1', 1788)]
Our simulation...
[-0.60375925  0.35087756  0.50699167  0.50529115]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6800298097761616
Probability=0.14523000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌──────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/4) ├┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├────────»
«         └────┬─────┘└────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■───────────┼────────────┼────────────┼──────┤0     ├»
«                          │            │            │      │      │»
«    j_1: ─────────────────■────────────┼────────────┼──────┤1     ├»
«                                       │            │      │  qft │»
«    j_2: ──────────────────────────────■────────────┼──────┤2     ├»
«                                                    │      │      │»
«    j_3: ───────────────────────────────────────────■──────┤3     ├»
«                                                           └──────┘»
«    q_0: ──────────────────────────────────────────────────────────»
«                                                                   »
«    q_1: ──────────────────────────────────────────────────────────»
«                                                                   »
«   cr_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_0: ══════════════════════════════════════════════════════════»
«                                                                   »
«crtmp_1: ══════════════════════════════════════════════════════════»
«                                                                   »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 3264), ('01 0', 24487), ('10 0', 21213), ('10 1', 3326), ('00 0', 20634), ('00 1', 4687), ('11 0', 20830), ('01 1', 1559)]
Our simulation...
[-0.60427221  0.34850435  0.50903339  0.50426662]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6794074575469143
Probability=0.12836
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.7328) ├┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 2884), ('01 0', 24593), ('10 0', 21529), ('10 1', 2918), ('00 0', 21158), ('00 1', 4085), ('11 0', 21381), ('01 1', 1452)]
Our simulation...
[-0.6002175   0.35784581  0.50728879  0.50432471]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.683248302702612
Probability=0.11339
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.68373) ├┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 2640), ('01 0', 24682), ('10 0', 21897), ('10 1', 2645), ('00 0', 21692), ('00 1', 3575), ('11 0', 21640), ('01 1', 1229)]
Our simulation...
[-0.59526995  0.34902126  0.51202218  0.511538  ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6903603670761373
Probability=0.10089
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.63794) ├┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 2230), ('01 0', 24614), ('10 0', 22282), ('10 1', 2323), ('00 0', 22003), ('00 1', 3206), ('11 0', 22208), ('01 1', 1134)]
Our simulation...
[-0.6004234   0.35709386  0.51109362  0.50075845]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6823909170128266
Probability=0.08893
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.59522) ├┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 2007), ('01 0', 24521), ('10 0', 22394), ('10 1', 2041), ('00 0', 22622), ('00 1', 2828), ('11 0', 22596), ('01 1', 991)]
Our simulation...
[-0.59956342  0.35492145  0.50935072  0.5050904 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6842806879897451
Probability=0.07867
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.55536) ├┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 1757), ('01 0', 24812), ('10 0', 22775), ('10 1', 1708), ('00 0', 22748), ('00 1', 2409), ('11 0', 22973), ('01 1', 818)]
Our simulation...
[-0.59998506  0.34962195  0.50520305  0.51239858]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6854212882454956
Probability=0.06692000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.51817) ├┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 1569), ('01 0', 24844), ('10 0', 23122), ('10 1', 1613), ('00 0', 22758), ('00 1', 2165), ('11 0', 23265), ('01 1', 664)]
Our simulation...
[-0.60014416  0.33236147  0.51801677  0.51090259]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6854966229822473
Probability=0.060110000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.48347) ├┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 1325), ('01 0', 24502), ('10 0', 23261), ('10 1', 1374), ('00 0', 23542), ('00 1', 1856), ('11 0', 23447), ('01 1', 693)]
Our simulation...
[-0.59469197  0.36338727  0.51167766  0.50247103]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6884082406672535
Probability=0.05248
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.45109) ├┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 1233), ('01 0', 24856), ('10 0', 23534), ('10 1', 1168), ('00 0', 23600), ('00 1', 1557), ('11 0', 23474), ('01 1', 578)]
Our simulation...
[-0.5858788   0.35696645  0.50744023  0.52136877]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7015464746495749
Probability=0.045360000000000004
--------------------------------------------------
--------------------------------------------------
Simulating with r=6.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.42088) ├┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 1000), ('01 0', 24584), ('10 0', 23910), ('10 1', 1075), ('00 0', 23566), ('00 1', 1457), ('11 0', 23920), ('01 1', 488)]
Our simulation...
[-0.60202808  0.34841503  0.51711985  0.49875467]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6806978370139883
Probability=0.0402
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────┐┌───────────┐┌───────────┐┌───────────┐        »
«    s_0: ┤ RY(pi/8) ├┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├────────»
«         └────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬─────┘┌──────┐»
«    j_0: ─────■────────────┼────────────┼────────────┼──────┤0     ├»
«                           │            │            │      │      │»
«    j_1: ──────────────────■────────────┼────────────┼──────┤1     ├»
«                                        │            │      │  qft │»
«    j_2: ───────────────────────────────■────────────┼──────┤2     ├»
«                                                     │      │      │»
«    j_3: ────────────────────────────────────────────■──────┤3     ├»
«                                                            └──────┘»
«    q_0: ───────────────────────────────────────────────────────────»
«                                                                    »
«    q_1: ───────────────────────────────────────────────────────────»
«                                                                    »
«   cr_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_0: ═══════════════════════════════════════════════════════════»
«                                                                    »
«crtmp_1: ═══════════════════════════════════════════════════════════»
«                                                                    »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 931), ('01 0', 24736), ('10 0', 24030), ('10 1', 812), ('00 0', 23765), ('00 1', 1273), ('11 0', 24056), ('01 1', 397)]
Our simulation...
[-0.61072551  0.34105711  0.48776414  0.52228397]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6753533848986648
Probability=0.03413
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.3664) ├┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 776), ('01 0', 24794), ('10 0', 24057), ('10 1', 788), ('00 0', 24076), ('00 1', 1108), ('11 0', 24028), ('01 1', 373)]
Our simulation...
[-0.60322069  0.34999414  0.50870905  0.50482077]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6805713787434413
Probability=0.03045
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.34186) ├┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 687), ('01 0', 24796), ('10 0', 24218), ('10 1', 690), ('00 0', 24285), ('00 1', 938), ('11 0', 24063), ('01 1', 323)]
Our simulation...
[-0.59629892  0.34991605  0.51143112  0.5103181 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6890030930333115
Probability=0.02638
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.31897) ├┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 584), ('01 0', 24715), ('10 0', 24462), ('10 1', 593), ('00 0', 24274), ('00 1', 820), ('11 0', 24256), ('01 1', 296)]
Our simulation...
[-0.59800512  0.35928892  0.50854023  0.50466641]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6855900907842611
Probability=0.022930000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.29761) ├┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 493), ('01 0', 24915), ('10 0', 24232), ('10 1', 519), ('00 0', 24383), ('00 1', 728), ('11 0', 24480), ('01 1', 250)]
Our simulation...
[-0.60483812  0.3544406   0.51068975  0.49773356]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6772107833306836
Probability=0.019899999999999998
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.27768) ├┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼───────┤0     ├»
«                               │              │              │       │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼───────┤1     ├»
«                                              │              │       │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼───────┤2     ├»
«                                                             │       │      │»
«    j_3: ────────────────────────────────────────────────────■───────┤3     ├»
«                                                                     └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«    q_1: ────────────────────────────────────────────────────────────────────»
«                                                                             »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 466), ('01 0', 25105), ('10 0', 24543), ('10 1', 469), ('00 0', 24487), ('00 1', 587), ('11 0', 24099), ('01 1', 244)]
Our simulation...
[-0.57653238  0.37170599  0.5153367   0.51368586]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7089074966015902
Probability=0.017660000000000002
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.25908) ├┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 379), ('01 0', 25056), ('10 0', 24297), ('10 1', 426), ('00 0', 24641), ('00 1', 525), ('11 0', 24474), ('01 1', 202)]
Our simulation...
[-0.5853967   0.36311677  0.52732142  0.49738218]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6969604605393914
Probability=0.01532
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.24173) ├┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 406), ('01 0', 24741), ('10 0', 24595), ('10 1', 336), ('00 0', 24563), ('00 1', 516), ('11 0', 24702), ('01 1', 141)]
Our simulation...
[-0.60731778  0.31746854  0.49007301  0.53870891]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6816426440906292
Probability=0.01399
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.22555) ├┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 297), ('01 0', 24928), ('10 0', 24725), ('10 1', 275), ('00 0', 24444), ('00 1', 467), ('11 0', 24712), ('01 1', 152)]
Our simulation...
[-0.62618486  0.3572448   0.48051889  0.49936988]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6533575794174786
Probability=0.01191
--------------------------------------------------
--------------------------------------------------
Simulating with r=7.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.21044) ├┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼───────────────┼────────»
«                               │              │               │        »
«    j_1: ──────────────────────■──────────────┼───────────────┼────────»
«                                              │               │        »
«    j_2: ─────────────────────────────────────■───────────────┼────────»
«                                                              │        »
«    j_3: ─────────────────────────────────────────────────────■────────»
«                                                                       »
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 259), ('01 0', 25012), ('10 0', 24925), ('10 1', 280), ('00 0', 24537), ('00 1', 361), ('11 0', 24526), ('01 1', 100)]
Our simulation...
[-0.60083276  0.31622777  0.52915026  0.50892043]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6841011472348529
Probability=0.009999999999999998
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌───────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/16) ├┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬─────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼────────────┼───────┤0     ├»
«                            │            │            │       │      │»
«    j_1: ───────────────────■────────────┼────────────┼───────┤1     ├»
«                                         │            │       │  qft │»
«    j_2: ────────────────────────────────■────────────┼───────┤2     ├»
«                                                      │       │      │»
«    j_3: ─────────────────────────────────────────────■───────┤3     ├»
«                                                              └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────»
«                                                                      »
«    q_1: ─────────────────────────────────────────────────────────────»
«                                                                      »
«   cr_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_0: ═════════════════════════════════════════════════════════════»
«                                                                      »
«crtmp_1: ═════════════════════════════════════════════════════════════»
«                                                                      »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 221), ('01 0', 24901), ('10 0', 24570), ('10 1', 225), ('00 0', 24741), ('00 1', 315), ('11 0', 24917), ('01 1', 110)]
Our simulation...
[-0.60137615  0.35537532  0.50825561  0.50371752]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6820480490780361
Probability=0.00871
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(0.1832) ├┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼─────────────┼───────┤0     ├»
«                             │             │             │       │      │»
«    j_1: ────────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                           │             │       │  qft │»
«    j_2: ──────────────────────────────────■─────────────┼───────┤2     ├»
«                                                         │       │      │»
«    j_3: ────────────────────────────────────────────────■───────┤3     ├»
«                                                                 └──────┘»
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 194), ('01 0', 25104), ('10 0', 24487), ('10 1', 199), ('00 0', 24870), ('00 1', 304), ('11 0', 24744), ('01 1', 98)]
Our simulation...
[-0.61837686  0.3510989   0.50031437  0.49398903]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6618868773720074
Probability=0.00795
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.17093) ├┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 167), ('01 0', 25068), ('10 0', 24931), ('10 1', 173), ('00 0', 24628), ('00 1', 257), ('11 0', 24681), ('01 1', 95)]
Our simulation...
[-0.60941553  0.37051753  0.5         0.49125297]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6696699514415472
Probability=0.00692
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.15949) ├┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 150), ('01 0', 24860), ('10 0', 24701), ('10 1', 162), ('00 0', 24923), ('00 1', 209), ('11 0', 24917), ('01 1', 78)]
Our simulation...
[-0.59069015  0.36085597  0.5200488   0.50041719]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6923431399407984
Probability=0.00599
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.14881) ├┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 133), ('01 0', 25050), ('10 0', 24781), ('10 1', 143), ('00 0', 24842), ('00 1', 202), ('11 0', 24792), ('01 1', 57)]
Our simulation...
[-0.61446732  0.32640781  0.5170007   0.49859616]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6677853706914827
Probability=0.005350000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌─────────────┐┌──────────────┐        »
«    s_0: ┤ RY(0.13884) ├┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├────────»
«         └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬───────┘┌──────┐»
«    j_0: ───────■──────────────┼──────────────┼──────────────┼────────┤0     ├»
«                               │              │              │        │      │»
«    j_1: ──────────────────────■──────────────┼──────────────┼────────┤1     ├»
«                                              │              │        │  qft │»
«    j_2: ─────────────────────────────────────■──────────────┼────────┤2     ├»
«                                                             │        │      │»
«    j_3: ────────────────────────────────────────────────────■────────┤3     ├»
«                                                                      └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«    q_1: ─────────────────────────────────────────────────────────────────────»
«                                                                              »
«   cr_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_0: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«crtmp_1: ═════════════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 118), ('01 0', 24945), ('10 0', 24945), ('10 1', 116), ('00 0', 24769), ('00 1', 147), ('11 0', 24906), ('01 1', 54)]
Our simulation...
[-0.58131836  0.35233213  0.51639778  0.52083046]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7065095917806591
Probability=0.00435
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12954) ├┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 92), ('01 0', 24842), ('10 0', 25196), ('10 1', 88), ('00 0', 24760), ('00 1', 141), ('11 0', 24828), ('01 1', 53)]
Our simulation...
[-0.61400761  0.37644552  0.48507125  0.49597309]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6646407794011554
Probability=0.0037400000000000003
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.12087) ├┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 96), ('01 0', 24935), ('10 0', 24936), ('10 1', 81), ('00 0', 24820), ('00 1', 129), ('11 0', 24956), ('01 1', 47)]
Our simulation...
[-0.60451559  0.36488968  0.47902167  0.52149274]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6801900765955887
Probability=0.0035299999999999997
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.11277) ├┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 74), ('01 0', 24951), ('10 0', 25010), ('10 1', 83), ('00 0', 24766), ('00 1', 99), ('11 0', 24980), ('01 1', 37)]
Our simulation...
[-0.58127787  0.35535878  0.53223721  0.50255321]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7026652535393912
Probability=0.00293
--------------------------------------------------
--------------------------------------------------
Simulating with r=8.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.10522) ├┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├»
«         └──────┬──────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■──────────────┼───────────────┼───────────────┼────────»
«                               │               │               │        »
«    j_1: ──────────────────────■───────────────┼───────────────┼────────»
«                                               │               │        »
«    j_2: ──────────────────────────────────────■───────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 65), ('01 0', 25149), ('10 0', 25138), ('10 1', 72), ('00 0', 24857), ('00 1', 100), ('11 0', 24589), ('01 1', 30)]
Our simulation...
[-0.61199006  0.33520076  0.51929079  0.49340216]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6692701740939434
Probability=0.00267
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌───────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/32) ├┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├────────»
«         └─────┬─────┘└─────┬─────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼────────────┼─────────────┼───────┤0     ├»
«                            │            │             │       │      │»
«    j_1: ───────────────────■────────────┼─────────────┼───────┤1     ├»
«                                         │             │       │  qft │»
«    j_2: ────────────────────────────────■─────────────┼───────┤2     ├»
«                                                       │       │      │»
«    j_3: ──────────────────────────────────────────────■───────┤3     ├»
«                                                               └──────┘»
«    q_0: ──────────────────────────────────────────────────────────────»
«                                                                       »
«    q_1: ──────────────────────────────────────────────────────────────»
«                                                                       »
«   cr_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_0: ══════════════════════════════════════════════════════════════»
«                                                                       »
«crtmp_1: ══════════════════════════════════════════════════════════════»
«                                                                       »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 59), ('01 0', 25135), ('10 0', 24867), ('10 1', 59), ('00 0', 24698), ('00 1', 91), ('11 0', 25072), ('01 1', 19)]
Our simulation...
[-0.63176167  0.28867513  0.5086963   0.5086963 ]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6495742148748346
Probability=0.00228
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.1...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌────────────┐┌────────────┐┌────────────┐┌─────────────┐        »
«    s_0: ┤ RY(0.0916) ├┤ RY(0.0458) ├┤ RY(0.0229) ├┤ RY(0.01145) ├────────»
«         └─────┬──────┘└─────┬──────┘└─────┬──────┘└──────┬──────┘┌──────┐»
«    j_0: ──────■─────────────┼─────────────┼──────────────┼───────┤0     ├»
«                             │             │              │       │      │»
«    j_1: ────────────────────■─────────────┼──────────────┼───────┤1     ├»
«                                           │              │       │  qft │»
«    j_2: ──────────────────────────────────■──────────────┼───────┤2     ├»
«                                                          │       │      │»
«    j_3: ─────────────────────────────────────────────────■───────┤3     ├»
«                                                                  └──────┘»
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 44), ('01 0', 24770), ('10 0', 25095), ('10 1', 37), ('00 0', 24851), ('00 1', 90), ('11 0', 25090), ('01 1', 23)]
Our simulation...
[-0.68111491  0.34432064  0.4367169   0.47623957]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.5836044911578013
Probability=0.0019399999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.2...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌──────────────┐»
«    s_0: ┤ RY(0.085466) ├┤ RY(0.042733) ├┤ RY(0.021367) ├┤ RY(0.010683) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└──────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼───────────────┼────────»
«                                │               │               │        »
«    j_1: ───────────────────────■───────────────┼───────────────┼────────»
«                                                │               │        »
«    j_2: ───────────────────────────────────────■───────────────┼────────»
«                                                                │        »
«    j_3: ───────────────────────────────────────────────────────■────────»
«                                                                         »
«    q_0: ────────────────────────────────────────────────────────────────»
«                                                                         »
«    q_1: ────────────────────────────────────────────────────────────────»
«                                                                         »
«   cr_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_0: ════════════════════════════════════════════════════════════════»
«                                                                         »
«crtmp_1: ════════════════════════════════════════════════════════════════»
«                                                                         »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 40), ('01 0', 25063), ('10 0', 24815), ('10 1', 37), ('00 0', 25063), ('00 1', 75), ('11 0', 24880), ('01 1', 27)]
Our simulation...
[-0.64729778  0.38837867  0.45464702  0.47271946]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6194420408704835
Probability=0.0017900000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.3...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.079743) ├┤ RY(0.039871) ├┤ RY(0.019936) ├┤ RY(0.0099678) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 36), ('01 0', 24884), ('10 0', 25138), ('10 1', 47), ('00 0', 24780), ('00 1', 49), ('11 0', 25049), ('01 1', 17)]
Our simulation...
[-0.57346234  0.33777797  0.56163711  0.49153915]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7071580015192768
Probability=0.00149
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.4...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.074403) ├┤ RY(0.037201) ├┤ RY(0.018601) ├┤ RY(0.0093003) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 25), ('01 0', 24844), ('10 0', 25024), ('10 1', 24), ('00 0', 24945), ('00 1', 31), ('11 0', 25090), ('01 1', 17)]
Our simulation...
[-0.56532082  0.41863795  0.497416    0.50767308]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7127499816389853
Probability=0.0009699999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.5...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌─────────────┐┌─────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.06942) ├┤ RY(0.03471) ├┤ RY(0.017355) ├┤ RY(0.0086775) ├»
«         └──────┬──────┘└──────┬──────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■──────────────┼──────────────┼────────────────┼────────»
«                               │              │                │        »
«    j_1: ──────────────────────■──────────────┼────────────────┼────────»
«                                              │                │        »
«    j_2: ─────────────────────────────────────■────────────────┼────────»
«                                                               │        »
«    j_3: ──────────────────────────────────────────────────────■────────»
«                                                                        »
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 26), ('01 0', 24876), ('10 0', 24739), ('10 1', 29), ('00 0', 25195), ('00 1', 33), ('11 0', 25088), ('01 1', 14)]
Our simulation...
[-0.56879646  0.37047929  0.53321077  0.50487816]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7149286135513299
Probability=0.0010199999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.6...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.064771) ├┤ RY(0.032386) ├┤ RY(0.016193) ├┤ RY(0.0080964) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 29), ('01 0', 24991), ('10 0', 24819), ('10 1', 27), ('00 0', 24994), ('00 1', 34), ('11 0', 25095), ('01 1', 11)]
Our simulation...
[-0.5802014   0.3300165   0.51703649  0.53584393]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7106067009642735
Probability=0.00101
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.7...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.060434) ├┤ RY(0.030217) ├┤ RY(0.015108) ├┤ RY(0.0075542) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 20), ('01 0', 25184), ('10 0', 24715), ('10 1', 14), ('00 0', 25144), ('00 1', 34), ('11 0', 24884), ('01 1', 5)]
Our simulation...
[-0.6824613   0.26171196  0.43792787  0.52342392]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.5877385110059675
Probability=0.0007300000000000001
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.8...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.056387) ├┤ RY(0.028193) ├┤ RY(0.014097) ├┤ RY(0.0070483) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 13), ('01 0', 25005), ('10 0', 24866), ('10 1', 18), ('00 0', 25027), ('00 1', 22), ('11 0', 25044), ('01 1', 5)]
Our simulation...
[-0.61588176  0.29361011  0.55708601  0.47343208]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.657687096378243
Probability=0.00058
--------------------------------------------------
--------------------------------------------------
Simulating with r=9.9...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌──────────────┐┌──────────────┐┌──────────────┐┌───────────────┐»
«    s_0: ┤ RY(0.052611) ├┤ RY(0.026305) ├┤ RY(0.013153) ├┤ RY(0.0065763) ├»
«         └──────┬───────┘└──────┬───────┘└──────┬───────┘└───────┬───────┘»
«    j_0: ───────■───────────────┼───────────────┼────────────────┼────────»
«                                │               │                │        »
«    j_1: ───────────────────────■───────────────┼────────────────┼────────»
«                                                │                │        »
«    j_2: ───────────────────────────────────────■────────────────┼────────»
«                                                                 │        »
«    j_3: ────────────────────────────────────────────────────────■────────»
«                                                                          »
«    q_0: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«    q_1: ─────────────────────────────────────────────────────────────────»
«                                                                          »
«   cr_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_0: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«crtmp_1: ═════════════════════════════════════════════════════════════════»
«                                                                          »
«                                                                 »
«    s_0: ────────────────────────────────────────────────────────»
«         ┌──────┐                                                »
«    j_0: ┤0     ├────────────────────────────────────────────────»
«         │      │                                                »
«    j_1: ┤1     ├───────────────────────────────────────■────────»
«         │  qft │                                       │        »
«    j_2: ┤2     ├───────────────────────■───────────────┼────────»
«         │      │                       │               │        »
«    j_3: ┤3     ├───────■───────────────┼───────────────┼────────»
«         └──────┘┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐»
«    q_0: ────────┤0             ├┤0             ├┤0             ├»
«                 │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg │»
«    q_1: ────────┤1             ├┤1             ├┤1             ├»
«                 └──────────────┘└──────────────┘└──────────────┘»
«   cr_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_0: ════════════════════════════════════════════════════════»
«                                                                 »
«crtmp_1: ════════════════════════════════════════════════════════»
«                                                                 »
«                           ░      ┌─┐ ░       
«    s_0: ──────────────────░──────┤M├─░───────
«                           ░ ┌───┐└╥┘ ░       
«    j_0: ────────■─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_1: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_2: ────────┼─────────░─┤ H ├─╫──░───────
«                 │         ░ ├───┤ ║  ░       
«    j_3: ────────┼─────────░─┤ H ├─╫──░───────
«         ┌──────┴┼───────┐ ░ └───┘ ║  ░ ┌─┐   
«    q_0: ┤0      │       ├─░───────╫──░─┤M├───
«         │  gate_1/16_dg │ ░       ║  ░ └╥┘┌─┐
«    q_1: ┤1              ├─░───────╫──░──╫─┤M├
«         └───────────────┘ ░       ║  ░  ║ └╥┘
«   cr_0: ══════════════════════════╩═════╬══╬═
«                                         ║  ║ 
«crtmp_0: ════════════════════════════════╩══╬═
«                                            ║ 
«crtmp_1: ═══════════════════════════════════╩═
«                                              
[('11 1', 16), ('01 0', 25335), ('10 0', 24820), ('10 1', 13), ('00 0', 24827), ('00 1', 26), ('11 0', 24956), ('01 1', 7)]
Our simulation...
[-0.64757613  0.33601075  0.45790547  0.50800051]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.6304344126141141
Probability=0.0006199999999999999
--------------------------------------------------
--------------------------------------------------
Simulating with r=10.0...
                                                                           »
    s_0: ──────────────────────────────────────────────────────────────────»
         ┌───┐                                                     ┌──────┐»
    j_0: ┤ H ├──────■──────────────────────────────────────────────┤0     ├»
         ├───┤      │                                              │      │»
    j_1: ┤ H ├──────┼─────────────■────────────────────────────────┤1     ├»
         ├───┤      │             │                                │  qft │»
    j_2: ┤ H ├──────┼─────────────┼────────────■───────────────────┤2     ├»
         ├───┤      │             │            │                   │      │»
    j_3: ┤ H ├──────┼─────────────┼────────────┼────────────■──────┤3     ├»
         ├───┤┌─────┴──────┐┌────┴┼─────┐┌────┴┼─────┐┌────┴┼─────┐└──────┘»
    q_0: ┤ H ├┤0           ├┤0    │     ├┤0    │     ├┤0    │     ├────────»
         ├───┤│  gate_1/16 ││  gate_1/8 ││  gate_1/4 ││  gate_1/2 │        »
    q_1: ┤ H ├┤1           ├┤1          ├┤1          ├┤1          ├────────»
         └───┘└────────────┘└───────────┘└───────────┘└───────────┘        »
   cr_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_0: ══════════════════════════════════════════════════════════════════»
                                                                           »
crtmp_1: ══════════════════════════════════════════════════════════════════»
                                                                           »
«         ┌───────────┐┌────────────┐┌────────────┐┌────────────┐        »
«    s_0: ┤ RY(pi/64) ├┤ RY(pi/128) ├┤ RY(pi/256) ├┤ RY(pi/512) ├────────»
«         └─────┬─────┘└─────┬──────┘└─────┬──────┘└─────┬──────┘┌──────┐»
«    j_0: ──────■────────────┼─────────────┼─────────────┼───────┤0     ├»
«                            │             │             │       │      │»
«    j_1: ───────────────────■─────────────┼─────────────┼───────┤1     ├»
«                                          │             │       │  qft │»
«    j_2: ─────────────────────────────────■─────────────┼───────┤2     ├»
«                                                        │       │      │»
«    j_3: ───────────────────────────────────────────────■───────┤3     ├»
«                                                                └──────┘»
«    q_0: ───────────────────────────────────────────────────────────────»
«                                                                        »
«    q_1: ───────────────────────────────────────────────────────────────»
«                                                                        »
«   cr_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_0: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«crtmp_1: ═══════════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           ░ »
«    s_0: ──────────────────────────────────────────────────────────────────░─»
«                                                                           ░ »
«    j_0: ────────────────────────────────────────────────────────■─────────░─»
«                                                                 │         ░ »
«    j_1: ───────────────────────────────────────■────────────────┼─────────░─»
«                                                │                │         ░ »
«    j_2: ───────────────────────■───────────────┼────────────────┼─────────░─»
«                                │               │                │         ░ »
«    j_3: ───────■───────────────┼───────────────┼────────────────┼─────────░─»
«         ┌──────┴───────┐┌──────┴───────┐┌──────┴───────┐┌──────┴┼───────┐ ░ »
«    q_0: ┤0             ├┤0             ├┤0             ├┤0      │       ├─░─»
«         │  gate_1/2_dg ││  gate_1/4_dg ││  gate_1/8_dg ││  gate_1/16_dg │ ░ »
«    q_1: ┤1             ├┤1             ├┤1             ├┤1              ├─░─»
«         └──────────────┘└──────────────┘└──────────────┘└───────────────┘ ░ »
«   cr_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_0: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«crtmp_1: ════════════════════════════════════════════════════════════════════»
«                                                                             »
«              ┌─┐ ░       
«    s_0: ─────┤M├─░───────
«         ┌───┐└╥┘ ░       
«    j_0: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_1: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_2: ┤ H ├─╫──░───────
«         ├───┤ ║  ░       
«    j_3: ┤ H ├─╫──░───────
«         └───┘ ║  ░ ┌─┐   
«    q_0: ──────╫──░─┤M├───
«               ║  ░ └╥┘┌─┐
«    q_1: ──────╫──░──╫─┤M├
«               ║  ░  ║ └╥┘
«   cr_0: ══════╩═════╬══╬═
«                     ║  ║ 
«crtmp_0: ════════════╩══╬═
«                        ║ 
«crtmp_1: ═══════════════╩═
«                          
[('11 1', 15), ('01 0', 24753), ('10 0', 25104), ('10 1', 15), ('00 0', 25125), ('00 1', 16), ('11 0', 24966), ('01 1', 6)]
Our simulation...
[-0.5547002   0.33968311  0.53708616  0.53708616]
Ans should be...
[-0.05423261  0.3796283   0.59655876  0.70502399]
Fidelity=0.7363325853799442
Probability=0.0005200000000000001
--------------------------------------------------
**************************************************
Max fidelity is 0.8862176426062134, when r=0.17
Min fidelity is 0.5724370928064154, when r=0.11
